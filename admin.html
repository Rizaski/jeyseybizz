<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Otomono Admin Panel - Management Dashboard</title>
    <meta name="description" content="Otomono Jerseys Admin Panel - Manage orders, customers, and business operations with our advanced dashboard.">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="public/favicon.png">
    <link rel="apple-touch-icon" href="public/favicon.png">

    <!-- ROG Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&family=Orbitron:wght@400;500;600;700;800;900&family=Exo+2:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Chart.js Library -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Firebase SDK -->
    <script type="module">
        // Direct Firebase configuration for admin panel
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, collection, getDocs, addDoc, updateDoc, deleteDoc, doc, query, orderBy, where, onSnapshot } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBNWEchdrKX9A2WdMa3VTnpbKgo0_eWqHE",
            authDomain: "otomono-c9938.firebaseapp.com",
            projectId: "otomono-c9938",
            storageBucket: "otomono-c9938.firebasestorage.app",
            messagingSenderId: "348906539551",
            appId: "1:348906539551:web:e249c40d0ae9e2964a632a",
            measurementId: "G-YVL497L1V3"
        };
        
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        // Make Firebase available globally
        window.firebaseAuth = auth;
        window.firebaseApp = app;
        window.firebaseDb = db;
        
        console.log('Firebase initialized for admin panel');
    </script>

    <!-- Custom Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'rog-red': '#ff0037',
                        'rog-orange': '#ff6b35',
                        'rog-dark': '#000000',
                        'rog-light': '#1a1a1a',
                        'rog-gray': '#333333',
                        'rog-blue': '#00d4ff',
                        'rog-purple': '#8b5cf6',
                    },
                    fontFamily: {
                        'rog-display': ['Orbitron', 'monospace'],
                        'rog-heading': ['Exo 2', 'sans-serif'],
                        'rog-body': ['Roboto', 'sans-serif'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.6s ease-out',
                        'slide-up': 'slideUp 0.8s ease-out',
                        'slide-in-left': 'slideInLeft 0.8s ease-out',
                        'slide-in-right': 'slideInRight 0.8s ease-out',
                        'bounce-slow': 'bounce 2s infinite',
                        'pulse-slow': 'pulse 3s infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': {
                                opacity: '0'
                            },
                            '100%': {
                                opacity: '1'
                            },
                        },
                        slideUp: {
                            '0%': {
                                transform: 'translateY(30px)',
                                opacity: '0'
                            },
                            '100%': {
                                transform: 'translateY(0)',
                                opacity: '1'
                            },
                        },
                        slideInLeft: {
                            '0%': {
                                transform: 'translateX(-30px)',
                                opacity: '0'
                            },
                            '100%': {
                                transform: 'translateX(0)',
                                opacity: '1'
                            },
                        },
                        slideInRight: {
                            '0%': {
                                transform: 'translateX(30px)',
                                opacity: '0'
                            },
                            '100%': {
                                transform: 'translateX(0)',
                                opacity: '1'
                            },
                        },
                        float: {
                            '0%, 100%': {
                                transform: 'translateY(0px)'
                            },
                            '50%': {
                                transform: 'translateY(-20px)'
                            },
                        },
                        glow: {
                            '0%': {
                                boxShadow: '0 0 20px rgba(220, 38, 38, 0.5)'
                            },
                            '100%': {
                                boxShadow: '0 0 30px rgba(220, 38, 38, 0.8)'
                            },
                        },
                    },
                }
            }
        }
    </script>

    <style>
        .rog-button {
            background: linear-gradient(135deg, #ff0037 0%, #ff6b35 50%, #00d4ff 100%);
            transition: all 0.3s ease;
            border: 1px solid #ff0037;
            box-shadow: 0 0 20px rgba(255, 0, 55, 0.3);
        }

        .rog-button:hover {
            background: linear-gradient(135deg, #ff6b35 0%, #ff0037 50%, #8b5cf6 100%);
            transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(255, 0, 55, 0.6);
            border-color: #00d4ff;
        }

        .hero-gradient {
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 30%, #333333 70%, #000000 100%);
            position: relative;
        }

        .hero-gradient::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 30% 20%, rgba(255, 0, 55, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 70% 80%, rgba(0, 212, 255, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        .glass-effect {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 0, 55, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .admin-card {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .admin-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 25px 50px rgba(255, 0, 55, 0.3), 0 0 30px rgba(0, 212, 255, 0.2);
        }

        .sidebar {
            transform: translateX(-100%);
            transition: transform 0.3s ease-in-out;
        }

        .sidebar.open {
            transform: translateX(0);
        }

        .mobile-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 40;
        }

        .mobile-overlay.active {
            display: block;
        }
    </style>

    <!-- Admin Authentication Protection -->
    <script>
        // Check admin authentication before page loads
        function checkAdminAuth() {
            console.log('Checking admin authentication...');

            // Check if admin user is logged in
            const adminUser = localStorage.getItem('adminUser');

            if (!adminUser) {
                console.log('No admin user found - redirecting to login');
                window.location.href = 'login.html';
                return false;
            }

            try {
                const adminData = JSON.parse(adminUser);
                console.log('Admin user found:', adminData);

                // Check if admin session is still valid (24 hours)
                const loginTime = new Date(adminData.loginTime);
                const now = new Date();
                const hoursDiff = (now - loginTime) / (1000 * 60 * 60);

                if (hoursDiff > 24) {
                    console.log('Admin session expired - redirecting to login');
                    localStorage.removeItem('adminUser');
                    window.location.href = 'login.html';
                    return false;
                }

                console.log('Admin authentication successful');
                return true;
            } catch (error) {
                console.error('Error parsing admin user data:', error);
                localStorage.removeItem('adminUser');
                window.location.href = 'login.html';
                return false;
            }
        }

        // Run authentication check immediately
        if (!checkAdminAuth()) {
            // Stop page loading if not authenticated
            document.body.innerHTML = '<div style="display: flex; justify-content: center; align-items: center; height: 100vh; background: #0a0a0a; color: #dc2626; font-family: Arial, sans-serif;"><div style="text-align: center;"><h2>Redirecting to login...</h2><p>Please wait...</p></div></div>';
        }
    </script>
</head>

<body class="bg-rog-dark text-white font-rog-body overflow-x-hidden">
    <!-- Mobile Overlay -->
    <div id="mobileOverlay" class="mobile-overlay" onclick="toggleSidebar()"></div>

    <!-- Header -->
    <header class="fixed top-0 left-0 right-0 z-50 glass-effect">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <!-- Logo Section -->
                <div class="flex items-center space-x-4">
                    <button id="sidebar-toggle" class="md:hidden text-white hover:text-rog-red transition-colors duration-300">
                        <i class="fas fa-bars text-2xl"></i>
                    </button>
                    <div class="flex items-center space-x-3">
                        <div class="w-10 h-10 bg-gradient-to-br from-rog-red to-rog-orange rounded-lg flex items-center justify-center">
                            <i class="fas fa-cog text-white text-lg"></i>
                        </div>
                        <div>
                            <h1 class="text-2xl font-rog-display font-bold text-white">ADMIN PANEL</h1>
                            <p class="text-sm text-gray-400 font-rog-body">Management Dashboard</p>
                        </div>
                    </div>
                </div>

                <!-- Header Actions -->
                <div class="flex items-center space-x-4">
                    <!-- Notifications -->
                    <div class="relative">
                        <button id="notification-btn" class="relative p-2 text-white hover:text-rog-red transition-colors duration-300">
                            <i class="fas fa-bell text-xl"></i>
                            <span id="notification-count" class="absolute -top-2 -right-2 bg-rog-red text-white text-xs rounded-full h-5 w-5 flex items-center justify-center hidden">0</span>
                        </button>
                        <div id="notification-center" class="absolute right-0 mt-2 w-80 bg-rog-light rounded-lg shadow-lg border border-rog-red/30 hidden z-50">
                            <div class="p-4 border-b border-rog-gray">
                                <h3 class="text-lg font-rog-heading font-semibold text-white">Notifications</h3>
                                <p class="text-sm text-gray-400 font-rog-body">Client submissions and updates</p>
                            </div>
                            <div id="notification-list" class="max-h-64 overflow-y-auto">
                                <!-- Notifications will be populated here -->
                            </div>
                        </div>
                    </div>

                    <!-- User Profile -->
                    <div class="relative">
                        <button id="user-profile-btn" class="w-10 h-10 bg-gradient-to-br from-rog-red to-rog-orange rounded-full flex items-center justify-center">
                            <i class="fas fa-user text-white"></i>
                        </button>
                        <div id="user-dropdown" class="absolute right-0 mt-2 w-48 bg-rog-light rounded-lg shadow-lg border border-rog-red/30 hidden">
                            <div class="p-4 border-b border-rog-gray">
                                <div class="flex items-center space-x-3 mb-3">
                                    <div class="w-10 h-10 bg-gradient-to-br from-rog-red to-rog-orange rounded-full flex items-center justify-center" id="admin-avatar">
                                        <i class="fas fa-user text-white text-sm"></i>
                                    </div>
                                    <div class="flex-1">
                                        <p class="text-sm text-gray-400 font-rog-body">Signed in as</p>
                                        <p class="font-rog-heading font-semibold text-white" id="admin-name">Admin User</p>
                                        <p class="text-xs text-gray-400 font-rog-body" id="admin-email">admin@otomono.mv</p>
                                    </div>
                                </div>
                                <div class="text-xs text-gray-400 font-rog-body">
                                    <p>Session: <span id="session-duration">0h 0m</span></p>
                                </div>
                            </div>
                            <div class="py-2">
                                <a href="#" class="block px-3 py-2 text-sm hover:bg-rog-gray rounded font-rog-body">Profile</a>
                                <a href="#" class="block px-3 py-2 text-sm hover:bg-rog-gray rounded font-rog-body">Settings</a>
                                <a href="#" class="block px-3 py-2 text-sm hover:bg-rog-gray rounded font-rog-body">Help</a>
                                <hr class="my-2 border-rog-gray">
                                <a href="#" class="block px-3 py-2 text-sm hover:bg-rog-gray rounded text-rog-red font-rog-body" onclick="logout()">Logout</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar fixed top-0 left-0 h-full w-80 bg-rog-light shadow-2xl z-40 md:translate-x-0">
        <div class="flex items-center justify-between p-6 border-b border-rog-gray">
            <div class="flex items-center space-x-3">
                <div class="w-8 h-8 bg-gradient-to-br from-rog-red to-rog-orange rounded-lg flex items-center justify-center">
                    <i class="fas fa-cog text-white text-sm"></i>
                </div>
                <div>
                    <h1 class="text-lg font-rog-display font-bold text-white">ADMIN</h1>
                    <p class="text-xs text-gray-400 font-rog-body">Dashboard</p>
                </div>
            </div>
            <button id="sidebar-close" class="md:hidden text-white hover:text-rog-red transition-colors duration-300">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>

        <nav class="p-6 space-y-2">
            <a href="#dashboard" class="flex items-center space-x-3 px-4 py-3 text-white hover:bg-rog-gray rounded-lg transition-colors duration-300 font-rog-body">
                <i class="fas fa-tachometer-alt text-rog-red"></i>
                <span>Dashboard</span>
            </a>
            <a href="#orders" class="flex items-center space-x-3 px-4 py-3 text-white hover:bg-rog-gray rounded-lg transition-colors duration-300 font-rog-body">
                <i class="fas fa-shopping-cart text-rog-red"></i>
                <span>Orders</span>
            </a>
            <a href="#customers" class="flex items-center space-x-3 px-4 py-3 text-white hover:bg-rog-gray rounded-lg transition-colors duration-300 font-rog-body">
                <i class="fas fa-users text-rog-red"></i>
                <span>Customers</span>
            </a>
            <a href="#materials" class="flex items-center space-x-3 px-4 py-3 text-white hover:bg-rog-gray rounded-lg transition-colors duration-300 font-rog-body">
                <i class="fas fa-layer-group text-rog-red"></i>
                <span>Materials</span>
            </a>
            <a href="designer-studio.html" class="flex items-center space-x-3 px-4 py-3 text-white hover:bg-rog-gray rounded-lg transition-colors duration-300 font-rog-body">
                <i class="fas fa-paint-brush text-rog-red"></i>
                <span>Design Studio</span>
            </a>
            <a href="#analytics" class="flex items-center space-x-3 px-4 py-3 text-white hover:bg-rog-gray rounded-lg transition-colors duration-300 font-rog-body">
                <i class="fas fa-chart-line text-rog-red"></i>
                <span>Analytics</span>
            </a>
            <a href="#reports" class="flex items-center space-x-3 px-4 py-3 text-white hover:bg-rog-gray rounded-lg transition-colors duration-300 font-rog-body">
                <i class="fas fa-file-alt text-rog-red"></i>
                <span>Reports</span>
            </a>
            <a href="#settings" class="flex items-center space-x-3 px-4 py-3 text-white hover:bg-rog-gray rounded-lg transition-colors duration-300 font-rog-body">
                <i class="fas fa-cog text-rog-red"></i>
                <span>Settings</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="md:ml-80 pt-20">
        <!-- Dashboard Section -->
        <section id="dashboard" class="p-6">
            <!-- Hero Section -->
            <div class="hero-gradient rounded-3xl p-8 mb-8 relative overflow-hidden">
                <div class="relative z-10">
                    <h1 class="text-4xl md:text-6xl font-rog-display font-bold mb-4 animate-fade-in">
                        Welcome to
                        <span class="text-transparent bg-clip-text bg-gradient-to-r from-rog-red via-rog-orange to-rog-blue animate-glow">
                            Admin Panel
                        </span>
                    </h1>
                    <p class="text-xl text-gray-300 mb-6 animate-slide-up font-rog-body">
                        Manage your jersey business with powerful tools and real-time insights.
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4 animate-slide-up">
                        <button class="rog-button px-6 py-3 rounded-lg font-rog-heading font-semibold text-white transition-all duration-300 hover:shadow-xl">
                            <i class="fas fa-plus mr-2"></i>
                            New Order
                        </button>
                        <button class="glass-effect px-6 py-3 rounded-lg font-rog-heading font-semibold text-white hover:bg-white hover:text-rog-dark transition-all duration-300">
                            <i class="fas fa-chart-bar mr-2"></i>
                            View Analytics
                        </button>
                    </div>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <!-- Total Orders -->
                <div class="admin-card bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30 hover:border-rog-red transition-all duration-300 animate-slide-in-left">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-gradient-to-br from-rog-red to-rog-orange rounded-lg flex items-center justify-center">
                            <i class="fas fa-shopping-cart text-white"></i>
                        </div>
                        <div class="text-right">
                            <p class="text-2xl font-rog-display font-bold text-white" id="dashboard-total-orders">0</p>
                            <p class="text-sm text-gray-400 font-rog-body">Total Orders</p>
                        </div>
                    </div>
                    <div class="flex items-center text-sm">
                        <i class="fas fa-arrow-up text-green-400 mr-1"></i>
                        <span class="text-green-400 font-rog-body" id="dashboard-orders-growth">+0% from last month</span>
                    </div>
                </div>

                <!-- Active Customers -->
                <div class="admin-card bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30 hover:border-rog-red transition-all duration-300 animate-slide-up">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-gradient-to-br from-rog-blue to-rog-purple rounded-lg flex items-center justify-center">
                            <i class="fas fa-users text-white"></i>
                        </div>
                        <div class="text-right">
                            <p class="text-2xl font-rog-display font-bold text-white" id="dashboard-active-customers">0</p>
                            <p class="text-sm text-gray-400 font-rog-body">Active Customers</p>
                        </div>
                    </div>
                    <div class="flex items-center text-sm">
                        <i class="fas fa-arrow-up text-green-400 mr-1"></i>
                        <span class="text-green-400 font-rog-body" id="dashboard-customers-growth">+0% from last month</span>
                    </div>
                </div>

                <!-- Pending Orders -->
                <div class="admin-card bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30 hover:border-rog-red transition-all duration-300 animate-slide-up">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-lg flex items-center justify-center">
                            <i class="fas fa-clock text-white"></i>
                        </div>
                        <div class="text-right">
                            <p class="text-2xl font-rog-display font-bold text-white" id="dashboard-pending-orders">0</p>
                            <p class="text-sm text-gray-400 font-rog-body">Pending Orders</p>
                        </div>
                    </div>
                    <div class="flex items-center text-sm">
                        <i class="fas fa-arrow-down text-red-400 mr-1"></i>
                        <span class="text-red-400 font-rog-body" id="dashboard-pending-change">-0 from yesterday</span>
                    </div>
                </div>

                <!-- Completed Orders -->
                <div class="admin-card bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30 hover:border-rog-red transition-all duration-300 animate-slide-in-right">
                    <div class="flex items-center justify-between mb-4">
                        <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center">
                            <i class="fas fa-check-circle text-white"></i>
                        </div>
                        <div class="text-right">
                            <p class="text-2xl font-rog-display font-bold text-white" id="dashboard-completed-orders">0</p>
                            <p class="text-sm text-gray-400 font-rog-body">Completed Orders</p>
                        </div>
                    </div>
                    <div class="flex items-center text-sm">
                        <i class="fas fa-arrow-up text-green-400 mr-1"></i>
                        <span class="text-green-400 font-rog-body" id="dashboard-completed-change">+0 from yesterday</span>
                    </div>
                </div>
            </div>

            <!-- Recent Orders -->
            <div class="bg-rog-light/20 backdrop-blur-sm rounded-2xl border border-rog-red/30 p-6 mb-8">
                <div class="flex items-center justify-between mb-6">
                    <h2 class="text-2xl font-rog-display font-bold text-white">Recent Orders</h2>
                    <button class="text-rog-red hover:text-rog-orange transition-colors duration-300 font-rog-body">
                        View All
                    </button>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b border-rog-gray">
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Order ID</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Customer</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Material</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Status</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Amount</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Date</th>
                            </tr>
                        </thead>
                        <tbody id="recent-orders-table-body">
                            <!-- Recent orders will be populated dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30 hover:border-rog-red transition-all duration-300">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-gradient-to-br from-rog-red to-rog-orange rounded-lg flex items-center justify-center mr-4">
                            <i class="fas fa-plus text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-rog-heading font-semibold text-white">Add New Order</h3>
                            <p class="text-sm text-gray-400 font-rog-body">Create a new customer order</p>
                        </div>
                    </div>
                    <button class="w-full rog-button py-2 rounded-lg font-rog-heading font-semibold text-white transition-all duration-300">
                        Create Order
                    </button>
                </div>

                <div class="bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30 hover:border-rog-red transition-all duration-300">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-gradient-to-br from-rog-purple to-rog-blue rounded-lg flex items-center justify-center mr-4">
                            <i class="fas fa-paint-brush text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-rog-heading font-semibold text-white">Design Studio</h3>
                            <p class="text-sm text-gray-400 font-rog-body">Create custom jersey designs</p>
                        </div>
                    </div>
                    <a href="designer-studio.html" class="w-full rog-button py-2 rounded-lg font-rog-heading font-semibold text-white transition-all duration-300 inline-block text-center">
                        <i class="fas fa-paint-brush mr-2"></i>
                        Start Designing
                    </a>
                </div>

                <div class="bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30 hover:border-rog-red transition-all duration-300">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-gradient-to-br from-rog-blue to-rog-purple rounded-lg flex items-center justify-center mr-4">
                            <i class="fas fa-chart-line text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-rog-heading font-semibold text-white">View Analytics</h3>
                            <p class="text-sm text-gray-400 font-rog-body">Business performance insights</p>
                        </div>
                    </div>
                    <button class="w-full glass-effect py-2 rounded-lg font-rog-heading font-semibold text-white hover:bg-white hover:text-rog-dark transition-all duration-300">
                        View Analytics
                    </button>
                </div>

                <div class="bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30 hover:border-rog-red transition-all duration-300">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center mr-4">
                            <i class="fas fa-file-alt text-white"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-rog-heading font-semibold text-white">Generate Report</h3>
                            <p class="text-sm text-gray-400 font-rog-body">Export business data</p>
                        </div>
                    </div>
                    <button class="w-full glass-effect py-2 rounded-lg font-rog-heading font-semibold text-white hover:bg-white hover:text-rog-dark transition-all duration-300">
                        Generate Report
                    </button>
                </div>
            </div>
        </section>

        <!-- Orders Section -->
        <section id="orders" class="p-6 hidden">
            <div class="mb-8">
                <h2 class="text-3xl font-rog-display font-bold text-white mb-4">Orders Management</h2>
                <p class="text-gray-400 font-rog-body">Manage customer orders and track their status</p>
            </div>

            <!-- Orders Filters -->
            <div class="bg-rog-light/20 backdrop-blur-sm rounded-2xl border border-rog-red/30 p-6 mb-8">
                <div class="grid md:grid-cols-4 gap-4">
                    <div>
                        <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Search Orders</label>
                        <input type="text" id="order-search" placeholder="Search by ID, customer, or product..." class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red">
                    </div>
                    <div>
                        <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Status Filter</label>
                        <select id="order-status-filter" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-rog-red">
                            <option value="">All Status</option>
                            <option value="pending">Pending</option>
                            <option value="processing">Processing</option>
                            <option value="shipped">Shipped</option>
                            <option value="delivered">Delivered</option>
                            <option value="cancelled">Cancelled</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Date Range</label>
                        <input type="date" id="order-date-from" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-rog-red">
                    </div>
                    <div class="flex items-end">
                        <button id="filter-orders" class="w-full rog-button py-3 rounded-lg font-rog-heading font-semibold text-white">
                            <i class="fas fa-filter mr-2"></i>Filter Orders
                        </button>
                    </div>
                </div>
            </div>

            <!-- Orders Table -->
            <div class="bg-rog-light/20 backdrop-blur-sm rounded-2xl border border-rog-red/30 p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-rog-heading font-semibold text-white">Orders List</h3>
                    <button id="add-order-btn" class="rog-button px-4 py-2 rounded-lg font-rog-heading font-semibold text-white">
                        <i class="fas fa-plus mr-2"></i>Add Order
                    </button>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b border-rog-gray">
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Order ID</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Customer</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Material</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Status</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Amount</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Date</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="orders-table-body">
                            <!-- Orders will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Customers Section -->
        <section id="customers" class="p-6 hidden">
            <div class="mb-8">
                <h2 class="text-3xl font-rog-display font-bold text-white mb-4">Customers Management</h2>
                <p class="text-gray-400 font-rog-body">Manage customer information and track their activity</p>
            </div>

            <!-- Customer Stats -->
            <div class="grid md:grid-cols-3 gap-6 mb-8">
                <div class="admin-card bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-rog-display font-bold text-white" id="total-customers">0</p>
                            <p class="text-sm text-gray-400 font-rog-body">Total Customers</p>
                        </div>
                        <div class="w-12 h-12 bg-gradient-to-br from-rog-blue to-rog-purple rounded-lg flex items-center justify-center">
                            <i class="fas fa-users text-white"></i>
                        </div>
                    </div>
                </div>
                <div class="admin-card bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-rog-display font-bold text-white" id="active-customers">0</p>
                            <p class="text-sm text-gray-400 font-rog-body">Active Customers</p>
                        </div>
                        <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center">
                            <i class="fas fa-user-check text-white"></i>
                        </div>
                    </div>
                </div>
                <div class="admin-card bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-rog-display font-bold text-white" id="new-customers">0</p>
                            <p class="text-sm text-gray-400 font-rog-body">New This Month</p>
                        </div>
                        <div class="w-12 h-12 bg-gradient-to-br from-rog-red to-rog-orange rounded-lg flex items-center justify-center">
                            <i class="fas fa-user-plus text-white"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Customers Table -->
            <div class="bg-rog-light/20 backdrop-blur-sm rounded-2xl border border-rog-red/30 p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-rog-heading font-semibold text-white">Customers List</h3>
                    <button id="add-customer-btn" class="rog-button px-4 py-2 rounded-lg font-rog-heading font-semibold text-white">
                        <i class="fas fa-plus mr-2"></i>Add Customer
                    </button>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b border-rog-gray">
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Name</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Email</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Phone</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Orders</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Status</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Joined</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="customers-table-body">
                            <!-- Customers will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Materials Section -->
        <section id="materials" class="p-6 hidden">
            <div class="mb-8">
                <h2 class="text-3xl font-rog-display font-bold text-white mb-4">Materials Management</h2>
                <p class="text-gray-400 font-rog-body">Manage jersey materials and inventory</p>
            </div>

            <!-- Material Categories -->
            <div class="grid md:grid-cols-4 gap-6 mb-8">
                <div class="admin-card bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-rog-display font-bold text-white" id="total-materials">0</p>
                            <p class="text-sm text-gray-400 font-rog-body">Total Materials</p>
                        </div>
                        <div class="w-12 h-12 bg-gradient-to-br from-rog-red to-rog-orange rounded-lg flex items-center justify-center">
                            <i class="fas fa-layer-group text-white"></i>
                        </div>
                    </div>
                </div>
                <div class="admin-card bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-rog-display font-bold text-white" id="materials-in-stock">0</p>
                            <p class="text-sm text-gray-400 font-rog-body">In Stock</p>
                        </div>
                        <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center">
                            <i class="fas fa-check-circle text-white"></i>
                        </div>
                    </div>
                </div>
                <div class="admin-card bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-rog-display font-bold text-white" id="materials-low-stock">0</p>
                            <p class="text-sm text-gray-400 font-rog-body">Low Stock</p>
                        </div>
                        <div class="w-12 h-12 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-lg flex items-center justify-center">
                            <i class="fas fa-exclamation-triangle text-white"></i>
                        </div>
                    </div>
                </div>
                <div class="admin-card bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-2xl font-rog-display font-bold text-white" id="materials-out-of-stock">0</p>
                            <p class="text-sm text-gray-400 font-rog-body">Out of Stock</p>
                        </div>
                        <div class="w-12 h-12 bg-gradient-to-br from-red-500 to-red-600 rounded-lg flex items-center justify-center">
                            <i class="fas fa-times-circle text-white"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Materials Table -->
            <div class="bg-rog-light/20 backdrop-blur-sm rounded-2xl border border-rog-red/30 p-6">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-xl font-rog-heading font-semibold text-white">Materials List</h3>
                    <button id="add-material-btn" class="rog-button px-4 py-2 rounded-lg font-rog-heading font-semibold text-white">
                        <i class="fas fa-plus mr-2"></i>Add Material
                    </button>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b border-rog-gray">
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Material</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Type</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Price per Unit</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Stock</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Status</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="materials-table-body">
                            <!-- Materials will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Analytics Section -->
        <section id="analytics" class="p-6 hidden">
            <div class="mb-8">
                <h2 class="text-3xl font-rog-display font-bold text-white mb-4">Analytics Dashboard</h2>
                <p class="text-gray-400 font-rog-body">Business insights and performance metrics</p>
            </div>

            <!-- Analytics Cards -->
            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="admin-card bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-2xl font-rog-display font-bold text-white" id="total-revenue">$0</p>
                            <p class="text-sm text-gray-400 font-rog-body">Total Revenue</p>
                        </div>
                        <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-lg flex items-center justify-center">
                            <i class="fas fa-dollar-sign text-white"></i>
                        </div>
                    </div>
                    <div class="flex items-center text-sm">
                        <i class="fas fa-arrow-up text-green-400 mr-1"></i>
                        <span class="text-green-400 font-rog-body">+15% from last month</span>
                    </div>
                </div>
                <div class="admin-card bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-2xl font-rog-display font-bold text-white" id="avg-order-value">$0</p>
                            <p class="text-sm text-gray-400 font-rog-body">Avg Order Value</p>
                        </div>
                        <div class="w-12 h-12 bg-gradient-to-br from-rog-blue to-rog-purple rounded-lg flex items-center justify-center">
                            <i class="fas fa-chart-line text-white"></i>
                        </div>
                    </div>
                    <div class="flex items-center text-sm">
                        <i class="fas fa-arrow-up text-green-400 mr-1"></i>
                        <span class="text-green-400 font-rog-body">+8% from last month</span>
                    </div>
                </div>
                <div class="admin-card bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-2xl font-rog-display font-bold text-white" id="conversion-rate">0%</p>
                            <p class="text-sm text-gray-400 font-rog-body">Conversion Rate</p>
                        </div>
                        <div class="w-12 h-12 bg-gradient-to-br from-rog-red to-rog-orange rounded-lg flex items-center justify-center">
                            <i class="fas fa-percentage text-white"></i>
                        </div>
                    </div>
                    <div class="flex items-center text-sm">
                        <i class="fas fa-arrow-up text-green-400 mr-1"></i>
                        <span class="text-green-400 font-rog-body">+3% from last month</span>
                    </div>
                </div>
                <div class="admin-card bg-rog-light/20 backdrop-blur-sm p-6 rounded-2xl border border-rog-red/30">
                    <div class="flex items-center justify-between mb-4">
                        <div>
                            <p class="text-2xl font-rog-display font-bold text-white" id="customer-satisfaction">0%</p>
                            <p class="text-sm text-gray-400 font-rog-body">Customer Satisfaction</p>
                        </div>
                        <div class="w-12 h-12 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-lg flex items-center justify-center">
                            <i class="fas fa-star text-white"></i>
                        </div>
                    </div>
                    <div class="flex items-center text-sm">
                        <i class="fas fa-arrow-up text-green-400 mr-1"></i>
                        <span class="text-green-400 font-rog-body">+5% from last month</span>
                    </div>
                </div>
            </div>

            <!-- Charts Section -->
            <div class="grid md:grid-cols-2 gap-6 mb-8">
                <div class="bg-rog-light/20 backdrop-blur-sm rounded-2xl border border-rog-red/30 p-6">
                    <h3 class="text-xl font-rog-heading font-semibold text-white mb-4">Sales Trend</h3>
                    <div class="relative h-64">
                        <canvas id="salesChart"></canvas>
                    </div>
                </div>
                <div class="bg-rog-light/20 backdrop-blur-sm rounded-2xl border border-rog-red/30 p-6">
                    <h3 class="text-xl font-rog-heading font-semibold text-white mb-4">Top Materials</h3>
                    <div class="relative h-64">
                        <canvas id="materialsChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Additional Charts -->
            <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-rog-light/20 backdrop-blur-sm rounded-2xl border border-rog-red/30 p-6">
                    <h3 class="text-xl font-rog-heading font-semibold text-white mb-4">Order Status Distribution</h3>
                    <div class="relative h-64">
                        <canvas id="statusChart"></canvas>
                    </div>
                </div>
                <div class="bg-rog-light/20 backdrop-blur-sm rounded-2xl border border-rog-red/30 p-6">
                    <h3 class="text-xl font-rog-heading font-semibold text-white mb-4">Monthly Revenue</h3>
                    <div class="relative h-64">
                        <canvas id="revenueChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Reports Section -->
        <section id="reports" class="p-6 hidden">
            <div class="mb-8">
                <h2 class="text-3xl font-rog-display font-bold text-white mb-4">Reports & Analytics</h2>
                <p class="text-gray-400 font-rog-body">Generate and download business reports</p>
            </div>

            <!-- Report Generation Controls -->
            <div class="bg-rog-light/20 backdrop-blur-sm rounded-2xl border border-rog-red/30 p-6 mb-8">
                <h3 class="text-xl font-rog-heading font-semibold text-white mb-4">Generate Reports</h3>
                <div class="grid md:grid-cols-2 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Report Type</label>
                        <select id="reportType" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-rog-red">
                            <option value="sales">Sales Report</option>
                            <option value="customers">Customer Report</option>
                            <option value="materials">Materials Report</option>
                            <option value="orders">Orders Report</option>
                            <option value="revenue">Revenue Report</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Date Range</label>
                        <select id="dateRange" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-rog-red">
                            <option value="last7days">Last 7 Days</option>
                            <option value="last30days">Last 30 Days</option>
                            <option value="last3months">Last 3 Months</option>
                            <option value="last6months">Last 6 Months</option>
                            <option value="lastyear">Last Year</option>
                            <option value="custom">Custom Range</option>
                        </select>
                    </div>
                </div>
                <div class="flex flex-wrap gap-4">
                    <button id="generateReportBtn" class="rog-button px-6 py-3 rounded-lg font-rog-heading font-semibold text-white">
                        <i class="fas fa-chart-bar mr-2"></i>Generate Report
                    </button>
                    <button id="exportPdfBtn" class="bg-red-600 hover:bg-red-700 px-6 py-3 rounded-lg font-rog-heading font-semibold text-white transition-colors duration-300" disabled>
                        <i class="fas fa-file-pdf mr-2"></i>Export PDF
                    </button>
                    <button id="exportExcelBtn" class="bg-green-600 hover:bg-green-700 px-6 py-3 rounded-lg font-rog-heading font-semibold text-white transition-colors duration-300" disabled>
                        <i class="fas fa-file-excel mr-2"></i>Export Excel
                    </button>
                    <button id="exportCsvBtn" class="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded-lg font-rog-heading font-semibold text-white transition-colors duration-300" disabled>
                        <i class="fas fa-file-csv mr-2"></i>Export CSV
                    </button>
                </div>
            </div>

            <!-- Report Preview -->
            <div id="reportPreview" class="bg-rog-light/20 backdrop-blur-sm rounded-2xl border border-rog-red/30 p-6 hidden">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-rog-heading font-semibold text-white">Report Preview</h3>
                    <button id="closeReportPreview" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <div id="reportContent" class="text-white">
                    <!-- Report content will be generated here -->
                </div>
            </div>

            <!-- Recent Reports -->
            <div class="bg-rog-light/20 backdrop-blur-sm rounded-2xl border border-rog-red/30 p-6">
                <h3 class="text-xl font-rog-heading font-semibold text-white mb-6">Recent Reports</h3>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead>
                            <tr class="border-b border-rog-gray">
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Report Name</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Type</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Generated</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Size</th>
                                <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="reports-table-body">
                            <!-- Reports will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <!-- Settings Section -->
        <section id="settings" class="p-6 hidden">
            <div class="mb-8">
                <h2 class="text-3xl font-rog-display font-bold text-white mb-4">Settings</h2>
                <p class="text-gray-400 font-rog-body">Configure system settings and preferences</p>
            </div>

            <!-- Settings Tabs -->
            <div class="bg-rog-light/20 backdrop-blur-sm rounded-2xl border border-rog-red/30 p-6">
                <div class="flex space-x-4 mb-6">
                    <button class="settings-tab active px-4 py-2 bg-rog-red text-white rounded-lg font-rog-heading font-semibold" data-tab="general">General</button>
                    <button class="settings-tab px-4 py-2 text-gray-400 hover:text-white rounded-lg font-rog-heading font-semibold" data-tab="notifications">Notifications</button>
                    <button class="settings-tab px-4 py-2 text-gray-400 hover:text-white rounded-lg font-rog-heading font-semibold" data-tab="security">Security</button>
                    <button class="settings-tab px-4 py-2 text-gray-400 hover:text-white rounded-lg font-rog-heading font-semibold" data-tab="integrations">Integrations</button>
                </div>

                <!-- General Settings -->
                <div id="general-settings" class="settings-content">
                    <h3 class="text-xl font-rog-heading font-semibold text-white mb-6">General Settings</h3>
                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Company Name</label>
                            <input type="text" id="company-name" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter company name">
                        </div>
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Email Address</label>
                            <input type="email" id="company-email" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter company email">
                        </div>
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Phone Number</label>
                            <input type="tel" id="company-phone" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter phone number">
                        </div>
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Address</label>
                            <textarea id="company-address" rows="3" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter company address"></textarea>
                        </div>
                        <button id="save-general-settings" class="rog-button px-6 py-3 rounded-lg font-rog-heading font-semibold text-white">
                            <i class="fas fa-save mr-2"></i>Save Settings
                        </button>
                    </div>
                </div>

                <!-- Notifications Settings -->
                <div id="notifications-settings" class="settings-content hidden">
                    <h3 class="text-xl font-rog-heading font-semibold text-white mb-6">Notification Settings</h3>
                    <div class="space-y-6">
                        <div class="flex items-center justify-between p-4 bg-rog-light/20 rounded-lg">
                            <div>
                                <h4 class="font-rog-heading font-semibold text-white">Email Notifications</h4>
                                <p class="text-sm text-gray-400 font-rog-body">Receive email notifications for new orders</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="email-notifications" class="sr-only peer" checked>
                                <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-rog-red"></div>
                            </label>
                        </div>
                        <div class="flex items-center justify-between p-4 bg-rog-light/20 rounded-lg">
                            <div>
                                <h4 class="font-rog-heading font-semibold text-white">SMS Notifications</h4>
                                <p class="text-sm text-gray-400 font-rog-body">Receive SMS notifications for urgent orders</p>
                            </div>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="sms-notifications" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-600 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-rog-red"></div>
                            </label>
                        </div>
                        <button id="save-notification-settings" class="rog-button px-6 py-3 rounded-lg font-rog-heading font-semibold text-white">
                            <i class="fas fa-save mr-2"></i>Save Settings
                        </button>
                    </div>
                </div>

                <!-- Security Settings -->
                <div id="security-settings" class="settings-content hidden">
                    <h3 class="text-xl font-rog-heading font-semibold text-white mb-6">Security Settings</h3>
                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Current Password</label>
                            <input type="password" id="current-password" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter current password">
                        </div>
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">New Password</label>
                            <input type="password" id="new-password" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter new password">
                        </div>
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Confirm New Password</label>
                            <input type="password" id="confirm-password" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Confirm new password">
                        </div>
                        <button id="save-security-settings" class="rog-button px-6 py-3 rounded-lg font-rog-heading font-semibold text-white">
                            <i class="fas fa-save mr-2"></i>Update Password
                        </button>
                    </div>
                </div>

                <!-- Integrations Settings -->
                <div id="integrations-settings" class="settings-content hidden">
                    <h3 class="text-xl font-rog-heading font-semibold text-white mb-6">Integration Settings</h3>
                    <div class="space-y-6">
                        <div class="p-4 bg-rog-light/20 rounded-lg">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h4 class="font-rog-heading font-semibold text-white">Firebase Integration</h4>
                                    <p class="text-sm text-gray-400 font-rog-body">Database and authentication services</p>
                                </div>
                                <span class="px-3 py-1 bg-green-500/20 text-green-400 rounded-full text-xs font-rog-body">Connected</span>
                            </div>
                            <div class="text-sm text-gray-400 font-rog-body">
                                <p>Project ID: otomono-c9938</p>
                                <p>Status: Active</p>
                            </div>
                        </div>
                        <div class="p-4 bg-rog-light/20 rounded-lg">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h4 class="font-rog-heading font-semibold text-white">Email Service</h4>
                                    <p class="text-sm text-gray-400 font-rog-body">SMTP configuration for notifications</p>
                                </div>
                                <span class="px-3 py-1 bg-yellow-500/20 text-yellow-400 rounded-full text-xs font-rog-body">Pending</span>
                            </div>
                            <button class="rog-button px-4 py-2 rounded-lg font-rog-heading font-semibold text-white text-sm">
                                <i class="fas fa-cog mr-2"></i>Configure
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- JavaScript -->
    <script>
        // Global variables
        let currentPage = 'dashboard';
        let ordersData = [];
        let customersData = [];
        let materialsData = [];
        let currentEditId = null;

        // Firebase imports
        let collection, getDocs, addDoc, updateDoc, deleteDoc, doc, query, orderBy, where, onSnapshot;

        // Initialize Firebase imports
        async function initializeFirebase() {
            try {
                const {
                    getFirestore,
                    collection: col,
                    getDocs: getDocsFn,
                    addDoc: addDocFn,
                    updateDoc: updateDocFn,
                    deleteDoc: deleteDocFn,
                    doc: docFn,
                    query: queryFn,
                    orderBy: orderByFn,
                    where: whereFn,
                    onSnapshot: onSnapshotFn
                } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js');

                collection = col;
                getDocs = getDocsFn;
                addDoc = addDocFn;
                updateDoc = updateDocFn;
                deleteDoc = deleteDocFn;
                doc = docFn;
                query = queryFn;
                orderBy = orderByFn;
                where = whereFn;
                onSnapshot = onSnapshotFn;

                console.log('Firebase Firestore imported successfully');
            } catch (error) {
                console.error('Error importing Firebase Firestore:', error);
            }
        }

        // Mobile sidebar functionality
        function setupMobileSidebar() {
            const sidebarToggle = document.getElementById('sidebar-toggle');
            const sidebar = document.getElementById('sidebar');
            const sidebarClose = document.getElementById('sidebar-close');
            const mobileOverlay = document.getElementById('mobileOverlay');

            function openSidebar() {
                sidebar.classList.add('open');
                mobileOverlay.classList.add('active');
                document.body.style.overflow = 'hidden';
            }

            function closeSidebar() {
                sidebar.classList.remove('open');
                mobileOverlay.classList.remove('active');
                document.body.style.overflow = '';
            }

            if (sidebarToggle) {
                sidebarToggle.addEventListener('click', (e) => {
                    e.preventDefault();
                    openSidebar();
                });
            }

            if (sidebarClose) {
                sidebarClose.addEventListener('click', (e) => {
                    e.preventDefault();
                    closeSidebar();
                });
            }

            if (mobileOverlay) {
                mobileOverlay.addEventListener('click', closeSidebar);
            }

            // Close sidebar when clicking on navigation links (but don't prevent navigation)
            sidebar.querySelectorAll('nav a').forEach(link => {
                link.addEventListener('click', (e) => {
                    // Only close sidebar for internal navigation links
                    if (link.getAttribute('href').startsWith('#')) {
                        closeSidebar();
                    }
                });
            });
        }

        // Navigation functionality
        function setupNavigation() {
            console.log('Setting up navigation...');
            const navLinks = document.querySelectorAll('nav a[href^="#"]');
            console.log('Found navigation links:', navLinks.length);

            navLinks.forEach((link, index) => {
                console.log(`Setting up link ${index}:`, link.getAttribute('href'));
                
                // Remove any existing event listeners
                link.removeEventListener('click', handleNavClick);
                
                // Add new event listener
                link.addEventListener('click', handleNavClick);
            });

            // Also add event delegation for dynamically added links
            document.addEventListener('click', (e) => {
                if (e.target.closest('nav a[href^="#"]')) {
                    e.preventDefault();
                    const link = e.target.closest('nav a[href^="#"]');
                    const targetId = link.getAttribute('href').substring(1);
                    console.log('Delegated navigation clicked:', targetId);
                    showPage(targetId);
                    updateActiveNavigation(targetId);
                }
            });
        }

        // Separate click handler function
        function handleNavClick(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            console.log('Navigation clicked:', targetId);
            showPage(targetId);
            updateActiveNavigation(targetId);
        }

        // Update active navigation state
        function updateActiveNavigation(activeId) {
            const navLinks = document.querySelectorAll('nav a[href^="#"]');
            navLinks.forEach(link => {
                const targetId = link.getAttribute('href').substring(1);
                if (targetId === activeId) {
                    link.classList.add('bg-rog-red', 'text-white');
                    link.classList.remove('text-white', 'hover:bg-rog-gray');
                } else {
                    link.classList.remove('bg-rog-red', 'text-white');
                    link.classList.add('text-white', 'hover:bg-rog-gray');
                }
            });
        }

        // Show specific page
        function showPage(pageId) {
            console.log('Showing page:', pageId);
            
            // Hide all sections
            const sections = document.querySelectorAll('main > section');
            console.log('Found sections:', sections.length);
            sections.forEach(section => {
                console.log('Hiding section:', section.id);
                section.classList.add('hidden');
            });

            // Show target section
            const targetSection = document.getElementById(pageId);
            console.log('Target section:', targetSection);
            if (targetSection) {
                console.log('Removing hidden class from:', pageId);
                targetSection.classList.remove('hidden');
                currentPage = pageId;
                console.log('Current page set to:', currentPage);

                // Load data for the page
                loadPageData(pageId);
            } else {
                console.error('Section not found:', pageId);
                // List all available sections for debugging
                const allSections = document.querySelectorAll('main > section');
                console.log('Available sections:');
                allSections.forEach(section => {
                    console.log('- Section ID:', section.id);
                });
            }
        }

        // Load data for specific page
        async function loadPageData(pageId) {
            switch (pageId) {
                case 'dashboard':
                    await loadDashboardData();
                    break;
                case 'orders':
                    await loadOrdersData();
                    break;
                case 'customers':
                    await loadCustomersData();
                    break;
                case 'materials':
                    await loadMaterialsData();
                    break;
                case 'analytics':
                    await loadAnalyticsData();
                    break;
                case 'reports':
                    await loadReportsData();
                    break;
                case 'settings':
                    await loadSettingsData();
                    break;
            }
        }

        // Firebase data loading functions
        async function loadDashboardData() {
            try {
                console.log('Loading dashboard data...');
                await loadRecentOrders();
                await loadDashboardStats();
            } catch (error) {
                console.error('Error loading dashboard data:', error);
            }
        }

        async function loadRecentOrders() {
            try {
                if (window.firebaseDb && collection) {
                    const ordersRef = collection(window.firebaseDb, 'orders');
                    const q = query(ordersRef, orderBy('createdAt', 'desc'));
                    const ordersSnapshot = await getDocs(q);
                    const recentOrders = ordersSnapshot.docs.slice(0, 5).map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                    renderRecentOrdersTable(recentOrders);
                } else {
                    renderRecentOrdersTable([]);
                }
            } catch (error) {
                console.error('Error loading recent orders:', error);
                renderRecentOrdersTable([]);
            }
        }

        async function loadDashboardStats() {
            try {
                if (window.firebaseDb && collection) {
                    // Load orders for stats
                    const ordersRef = collection(window.firebaseDb, 'orders');
                    const ordersSnapshot = await getDocs(ordersRef);
                    const orders = ordersSnapshot.docs.map(doc => doc.data());

                    // Load customers for stats
                    const customersRef = collection(window.firebaseDb, 'customers');
                    const customersSnapshot = await getDocs(customersRef);
                    const customers = customersSnapshot.docs.map(doc => doc.data());

                    updateDashboardStats(orders, customers);
                } else {
                    updateDashboardStats([], []);
                }
            } catch (error) {
                console.error('Error loading dashboard stats:', error);
                updateDashboardStats([], []);
            }
        }

        function updateDashboardStats(orders, customers) {
            const totalOrders = orders.length;
            const activeCustomers = customers.filter(c => c.status === 'active').length;
            const pendingOrders = orders.filter(o => o.status === 'pending').length;
            const completedOrders = orders.filter(o => o.status === 'completed').length;

            // Update dashboard stats
            const totalOrdersEl = document.getElementById('dashboard-total-orders');
            const activeCustomersEl = document.getElementById('dashboard-active-customers');
            const pendingOrdersEl = document.getElementById('dashboard-pending-orders');
            const completedOrdersEl = document.getElementById('dashboard-completed-orders');

            if (totalOrdersEl) totalOrdersEl.textContent = totalOrders;
            if (activeCustomersEl) activeCustomersEl.textContent = activeCustomers;
            if (pendingOrdersEl) pendingOrdersEl.textContent = pendingOrders;
            if (completedOrdersEl) completedOrdersEl.textContent = completedOrders;
        }

        function renderRecentOrdersTable(orders) {
            const tbody = document.getElementById('recent-orders-table-body');
            if (!tbody) return;

            if (orders.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="py-8 text-center text-gray-400 font-rog-body">No recent orders</td></tr>';
                return;
            }

            tbody.innerHTML = orders.map(order => `
                <tr class="border-b border-rog-gray/50">
                    <td class="py-3 px-4 font-rog-body text-gray-300">${order.id || 'N/A'}</td>
                    <td class="py-3 px-4 font-rog-body text-gray-300">${order.customer || 'N/A'}</td>
                    <td class="py-3 px-4 font-rog-body text-gray-300">${order.material || 'N/A'}</td>
                    <td class="py-3 px-4">
                        <span class="px-2 py-1 ${getStatusColor(order.status)} rounded-full text-xs font-rog-body">${order.status || 'N/A'}</span>
                    </td>
                    <td class="py-3 px-4 font-rog-body text-gray-300">$${order.amount || '0.00'}</td>
                    <td class="py-3 px-4 font-rog-body text-gray-300">${order.date || 'N/A'}</td>
                </tr>
            `).join('');
        }

        async function loadOrdersData() {
            try {
                console.log('Loading orders data...');
                if (window.firebaseDb) {
                    const ordersRef = collection(window.firebaseDb, 'orders');
                    const ordersSnapshot = await getDocs(ordersRef);
                    ordersData = ordersSnapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                    renderOrdersTable();
                } else {
                    ordersData = [];
                    renderOrdersTable();
                }
            } catch (error) {
                console.error('Error loading orders data:', error);
            }
        }

        async function loadCustomersData() {
            try {
                console.log('Loading customers data...');
                if (window.firebaseDb) {
                    const customersRef = collection(window.firebaseDb, 'customers');
                    const customersSnapshot = await getDocs(customersRef);
                    customersData = customersSnapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                    renderCustomersTable();
                    updateCustomerStats();
                } else {
                    customersData = [];
                    renderCustomersTable();
                    updateCustomerStats();
                }
            } catch (error) {
                console.error('Error loading customers data:', error);
            }
        }

        async function loadMaterialsData() {
            try {
                console.log('Loading materials data...');
                if (window.firebaseDb && collection) {
                    const materialsRef = collection(window.firebaseDb, 'materials');
                    const q = query(materialsRef, orderBy('createdAt', 'desc'));
                    const materialsSnapshot = await getDocs(q);
                    materialsData = materialsSnapshot.docs.map(doc => ({
                        id: doc.id,
                        ...doc.data()
                    }));
                    renderMaterialsTable();
                    updateMaterialStats();
                } else {
                    materialsData = [];
                    renderMaterialsTable();
                    updateMaterialStats();
                }
            } catch (error) {
                console.error('Error loading materials data:', error);
                materialsData = [];
                renderMaterialsTable();
                updateMaterialStats();
            }
        }

        async function loadAnalyticsData() {
            try {
                console.log('Loading analytics data...');
                await updateAnalyticsStats();
                await loadCharts();
            } catch (error) {
                console.error('Error loading analytics data:', error);
            }
        }

        // Chart functionality
        let salesChart, materialsChart, statusChart, revenueChart;

        async function loadCharts() {
            try {
                if (window.firebaseDb && collection) {
                    // Load data for charts
                    const ordersRef = collection(window.firebaseDb, 'orders');
                    const ordersSnapshot = await getDocs(ordersRef);
                    const orders = ordersSnapshot.docs.map(doc => doc.data());

                    const materialsRef = collection(window.firebaseDb, 'materials');
                    const materialsSnapshot = await getDocs(materialsRef);
                    const materials = materialsSnapshot.docs.map(doc => doc.data());

                    // Create charts
                    createSalesChart(orders);
                    createMaterialsChart(orders);
                    createStatusChart(orders);
                    createRevenueChart(orders);
                } else {
                    // Create empty charts
                    createEmptyCharts();
                }
            } catch (error) {
                console.error('Error loading charts:', error);
                createEmptyCharts();
            }
        }

        function createSalesChart(orders) {
            const ctx = document.getElementById('salesChart');
            if (!ctx) return;

            // Process sales data by date
            const salesData = processSalesData(orders);

            if (salesChart) salesChart.destroy();

            salesChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: salesData.labels,
                    datasets: [{
                        label: 'Sales ($)',
                        data: salesData.values,
                        borderColor: '#ff0037',
                        backgroundColor: 'rgba(255, 0, 55, 0.1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#ffffff'
                            }
                        }
                    },
                    scales: {
                        x: {
                            ticks: {
                                color: '#ffffff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        y: {
                            ticks: {
                                color: '#ffffff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });
        }

        function createMaterialsChart(orders) {
            const ctx = document.getElementById('materialsChart');
            if (!ctx) return;

            // Process materials data
            const materialsData = processMaterialsData(orders);

            if (materialsChart) materialsChart.destroy();

            materialsChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: materialsData.labels,
                    datasets: [{
                        data: materialsData.values,
                        backgroundColor: [
                            '#ff0037',
                            '#ff6b35',
                            '#00d4ff',
                            '#8b5cf6',
                            '#10b981',
                            '#f59e0b',
                            '#ef4444',
                            '#3b82f6'
                        ],
                        borderWidth: 2,
                        borderColor: '#1a1a1a'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#ffffff',
                                padding: 20
                            }
                        }
                    }
                }
            });
        }

        function createStatusChart(orders) {
            const ctx = document.getElementById('statusChart');
            if (!ctx) return;

            // Process status data
            const statusData = processStatusData(orders);

            if (statusChart) statusChart.destroy();

            statusChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: statusData.labels,
                    datasets: [{
                        data: statusData.values,
                        backgroundColor: [
                            '#f59e0b', // pending
                            '#10b981', // completed
                            '#ef4444', // cancelled
                            '#3b82f6' // processing
                        ],
                        borderWidth: 2,
                        borderColor: '#1a1a1a'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: '#ffffff',
                                padding: 20
                            }
                        }
                    }
                }
            });
        }

        function createRevenueChart(orders) {
            const ctx = document.getElementById('revenueChart');
            if (!ctx) return;

            // Process revenue data
            const revenueData = processRevenueData(orders);

            if (revenueChart) revenueChart.destroy();

            revenueChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: revenueData.labels,
                    datasets: [{
                        label: 'Revenue ($)',
                        data: revenueData.values,
                        backgroundColor: 'rgba(255, 0, 55, 0.8)',
                        borderColor: '#ff0037',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: {
                                color: '#ffffff'
                            }
                        }
                    },
                    scales: {
                        x: {
                            ticks: {
                                color: '#ffffff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        },
                        y: {
                            ticks: {
                                color: '#ffffff'
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.1)'
                            }
                        }
                    }
                }
            });
        }

        function createEmptyCharts() {
            // Create empty charts when no data is available
            const charts = ['salesChart', 'materialsChart', 'statusChart', 'revenueChart'];
            charts.forEach(chartId => {
                const ctx = document.getElementById(chartId);
                if (ctx) {
                    ctx.getContext('2d').clearRect(0, 0, ctx.width, ctx.height);
                }
            });
        }

        // Data processing functions
        function processSalesData(orders) {
            const last7Days = [];
            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                last7Days.push(date.toISOString().split('T')[0]);
            }

            const salesByDate = {};
            last7Days.forEach(date => {
                salesByDate[date] = 0;
            });

            orders.forEach(order => {
                const orderDate = order.date || order.createdAt ? .toDate ? .() ? .toISOString().split('T')[0];
                if (salesByDate.hasOwnProperty(orderDate)) {
                    salesByDate[orderDate] += parseFloat(order.amount) || 0;
                }
            });

            return {
                labels: last7Days.map(date => new Date(date).toLocaleDateString()),
                values: last7Days.map(date => salesByDate[date])
            };
        }

        function processMaterialsData(orders) {
            const materialCounts = {};
            orders.forEach(order => {
                const material = order.material || 'Unknown';
                materialCounts[material] = (materialCounts[material] || 0) + 1;
            });

            const sortedMaterials = Object.entries(materialCounts)
                .sort(([, a], [, b]) => b - a)
                .slice(0, 8);

            return {
                labels: sortedMaterials.map(([material]) => material),
                values: sortedMaterials.map(([, count]) => count)
            };
        }

        function processStatusData(orders) {
            const statusCounts = {};
            orders.forEach(order => {
                const status = order.status || 'Unknown';
                statusCounts[status] = (statusCounts[status] || 0) + 1;
            });

            return {
                labels: Object.keys(statusCounts),
                values: Object.values(statusCounts)
            };
        }

        function processRevenueData(orders) {
            const last6Months = [];
            for (let i = 5; i >= 0; i--) {
                const date = new Date();
                date.setMonth(date.getMonth() - i);
                last6Months.push(date.toISOString().substring(0, 7));
            }

            const revenueByMonth = {};
            last6Months.forEach(month => {
                revenueByMonth[month] = 0;
            });

            orders.forEach(order => {
                const orderDate = order.date || order.createdAt ? .toDate ? .() ? .toISOString().substring(0, 7);
                if (revenueByMonth.hasOwnProperty(orderDate)) {
                    revenueByMonth[orderDate] += parseFloat(order.amount) || 0;
                }
            });

            return {
                labels: last6Months.map(month => new Date(month + '-01').toLocaleDateString('en-US', {
                    month: 'short',
                    year: 'numeric'
                })),
                values: last6Months.map(month => revenueByMonth[month])
            };
        }

        async function loadReportsData() {
            try {
                console.log('Loading reports data...');
                setupReportGeneration();
            } catch (error) {
                console.error('Error loading reports data:', error);
            }
        }

        // Report generation functionality
        function setupReportGeneration() {
            const generateBtn = document.getElementById('generateReportBtn');
            const exportPdfBtn = document.getElementById('exportPdfBtn');
            const exportExcelBtn = document.getElementById('exportExcelBtn');
            const exportCsvBtn = document.getElementById('exportCsvBtn');
            const closePreviewBtn = document.getElementById('closeReportPreview');
            const reportPreview = document.getElementById('reportPreview');
            const reportContent = document.getElementById('reportContent');

            if (generateBtn) {
                generateBtn.addEventListener('click', async () => {
                    await generateReport();
                });
            }

            if (exportPdfBtn) {
                exportPdfBtn.addEventListener('click', () => {
                    exportReport('pdf');
                });
            }

            if (exportExcelBtn) {
                exportExcelBtn.addEventListener('click', () => {
                    exportReport('excel');
                });
            }

            if (exportCsvBtn) {
                exportCsvBtn.addEventListener('click', () => {
                    exportReport('csv');
                });
            }

            if (closePreviewBtn && reportPreview) {
                closePreviewBtn.addEventListener('click', () => {
                    reportPreview.classList.add('hidden');
                });
            }
        }

        async function generateReport() {
            try {
                const reportType = document.getElementById('reportType').value;
                const dateRange = document.getElementById('dateRange').value;

                // Show loading state
                const generateBtn = document.getElementById('generateReportBtn');
                const originalText = generateBtn.innerHTML;
                generateBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Generating...';
                generateBtn.disabled = true;

                // Load data based on report type
                let reportData = {};
                if (window.firebaseDb && collection) {
                    switch (reportType) {
                        case 'sales':
                            reportData = await generateSalesReport(dateRange);
                            break;
                        case 'customers':
                            reportData = await generateCustomerReport(dateRange);
                            break;
                        case 'materials':
                            reportData = await generateMaterialsReport(dateRange);
                            break;
                        case 'orders':
                            reportData = await generateOrdersReport(dateRange);
                            break;
                        case 'revenue':
                            reportData = await generateRevenueReport(dateRange);
                            break;
                    }
                }

                // Display report preview
                displayReportPreview(reportType, reportData);

                // Enable export buttons
                document.getElementById('exportPdfBtn').disabled = false;
                document.getElementById('exportExcelBtn').disabled = false;
                document.getElementById('exportCsvBtn').disabled = false;

                // Reset button
                generateBtn.innerHTML = originalText;
                generateBtn.disabled = false;

            } catch (error) {
                console.error('Error generating report:', error);
                alert('Error generating report. Please try again.');
            }
        }

        async function generateSalesReport(dateRange) {
            const ordersRef = collection(window.firebaseDb, 'orders');
            const ordersSnapshot = await getDocs(ordersRef);
            const orders = ordersSnapshot.docs.map(doc => ({
                id: doc.id,
                ...doc.data()
            }));

            const filteredOrders = filterOrdersByDateRange(orders, dateRange);
            const totalRevenue = filteredOrders.reduce((sum, order) => sum + (parseFloat(order.amount) || 0), 0);
            const totalOrders = filteredOrders.length;
            const avgOrderValue = totalOrders > 0 ? totalRevenue / totalOrders : 0;

            return {
                title: 'Sales Report',
                period: getDateRangeLabel(dateRange),
                totalRevenue,
                totalOrders,
                avgOrderValue,
                orders: filteredOrders,
                generatedAt: new Date().toISOString()
            };
        }

        async function generateCustomerReport(dateRange) {
            const customersRef = collection(window.firebaseDb, 'customers');
            const customersSnapshot = await getDocs(customersRef);
            const customers = customersSnapshot.docs.map(doc => ({
                id: doc.id,
                ...doc.data()
            }));

            const ordersRef = collection(window.firebaseDb, 'orders');
            const ordersSnapshot = await getDocs(ordersRef);
            const orders = ordersSnapshot.docs.map(doc => ({
                id: doc.id,
                ...doc.data()
            }));

            const filteredOrders = filterOrdersByDateRange(orders, dateRange);
            const activeCustomers = customers.filter(c => c.status === 'active').length;
            const newCustomers = customers.filter(c => {
                const joinedDate = new Date(c.joined || c.createdAt ? .toDate ? .());
                return isDateInRange(joinedDate, dateRange);
            }).length;

            return {
                title: 'Customer Report',
                period: getDateRangeLabel(dateRange),
                totalCustomers: customers.length,
                activeCustomers,
                newCustomers,
                customers,
                orders: filteredOrders,
                generatedAt: new Date().toISOString()
            };
        }

        async function generateMaterialsReport(dateRange) {
            const materialsRef = collection(window.firebaseDb, 'materials');
            const materialsSnapshot = await getDocs(materialsRef);
            const materials = materialsSnapshot.docs.map(doc => ({
                id: doc.id,
                ...doc.data()
            }));

            const ordersRef = collection(window.firebaseDb, 'orders');
            const ordersSnapshot = await getDocs(ordersRef);
            const orders = ordersSnapshot.docs.map(doc => ({
                id: doc.id,
                ...doc.data()
            }));

            const filteredOrders = filterOrdersByDateRange(orders, dateRange);
            const materialUsage = {};
            filteredOrders.forEach(order => {
                const material = order.material || 'Unknown';
                materialUsage[material] = (materialUsage[material] || 0) + 1;
            });

            return {
                title: 'Materials Report',
                period: getDateRangeLabel(dateRange),
                totalMaterials: materials.length,
                materials,
                materialUsage,
                orders: filteredOrders,
                generatedAt: new Date().toISOString()
            };
        }

        async function generateOrdersReport(dateRange) {
            const ordersRef = collection(window.firebaseDb, 'orders');
            const ordersSnapshot = await getDocs(ordersRef);
            const orders = ordersSnapshot.docs.map(doc => ({
                id: doc.id,
                ...doc.data()
            }));

            const filteredOrders = filterOrdersByDateRange(orders, dateRange);
            const statusCounts = {};
            filteredOrders.forEach(order => {
                const status = order.status || 'Unknown';
                statusCounts[status] = (statusCounts[status] || 0) + 1;
            });

            return {
                title: 'Orders Report',
                period: getDateRangeLabel(dateRange),
                totalOrders: filteredOrders.length,
                orders: filteredOrders,
                statusCounts,
                generatedAt: new Date().toISOString()
            };
        }

        async function generateRevenueReport(dateRange) {
            const ordersRef = collection(window.firebaseDb, 'orders');
            const ordersSnapshot = await getDocs(ordersRef);
            const orders = ordersSnapshot.docs.map(doc => ({
                id: doc.id,
                ...doc.data()
            }));

            const filteredOrders = filterOrdersByDateRange(orders, dateRange);
            const totalRevenue = filteredOrders.reduce((sum, order) => sum + (parseFloat(order.amount) || 0), 0);
            const revenueByMonth = {};

            filteredOrders.forEach(order => {
                const orderDate = order.date || order.createdAt ? .toDate ? .() ? .toISOString().substring(0, 7);
                if (orderDate) {
                    revenueByMonth[orderDate] = (revenueByMonth[orderDate] || 0) + (parseFloat(order.amount) || 0);
                }
            });

            return {
                title: 'Revenue Report',
                period: getDateRangeLabel(dateRange),
                totalRevenue,
                revenueByMonth,
                orders: filteredOrders,
                generatedAt: new Date().toISOString()
            };
        }

        function filterOrdersByDateRange(orders, dateRange) {
            const now = new Date();
            const startDate = new Date();

            switch (dateRange) {
                case 'last7days':
                    startDate.setDate(now.getDate() - 7);
                    break;
                case 'last30days':
                    startDate.setDate(now.getDate() - 30);
                    break;
                case 'last3months':
                    startDate.setMonth(now.getMonth() - 3);
                    break;
                case 'last6months':
                    startDate.setMonth(now.getMonth() - 6);
                    break;
                case 'lastyear':
                    startDate.setFullYear(now.getFullYear() - 1);
                    break;
                default:
                    return orders;
            }

            return orders.filter(order => {
                const orderDate = new Date(order.date || order.createdAt ? .toDate ? .());
                return orderDate >= startDate && orderDate <= now;
            });
        }

        function getDateRangeLabel(dateRange) {
            const labels = {
                'last7days': 'Last 7 Days',
                'last30days': 'Last 30 Days',
                'last3months': 'Last 3 Months',
                'last6months': 'Last 6 Months',
                'lastyear': 'Last Year',
                'custom': 'Custom Range'
            };
            return labels[dateRange] || 'All Time';
        }

        function isDateInRange(date, dateRange) {
            const now = new Date();
            const startDate = new Date();

            switch (dateRange) {
                case 'last7days':
                    startDate.setDate(now.getDate() - 7);
                    break;
                case 'last30days':
                    startDate.setDate(now.getDate() - 30);
                    break;
                case 'last3months':
                    startDate.setMonth(now.getMonth() - 3);
                    break;
                case 'last6months':
                    startDate.setMonth(now.getMonth() - 6);
                    break;
                case 'lastyear':
                    startDate.setFullYear(now.getFullYear() - 1);
                    break;
                default:
                    return true;
            }

            return date >= startDate && date <= now;
        }

        function displayReportPreview(reportType, reportData) {
            const reportPreview = document.getElementById('reportPreview');
            const reportContent = document.getElementById('reportContent');

            if (!reportPreview || !reportContent) return;

            let html = `
                <div class="mb-6">
                    <h4 class="text-2xl font-rog-display font-bold text-white mb-2">${reportData.title}</h4>
                    <p class="text-gray-400 font-rog-body">Period: ${reportData.period}</p>
                    <p class="text-gray-400 font-rog-body">Generated: ${new Date(reportData.generatedAt).toLocaleString()}</p>
                </div>
            `;

            // Add report-specific content with tables
            switch (reportType) {
                case 'sales':
                    html += `
                        <div class="grid md:grid-cols-3 gap-4 mb-6">
                            <div class="bg-rog-light/20 p-4 rounded-lg">
                                <h5 class="text-lg font-rog-heading font-semibold text-white">Total Revenue</h5>
                                <p class="text-2xl font-rog-display font-bold text-rog-red">$${reportData.totalRevenue.toFixed(2)}</p>
                            </div>
                            <div class="bg-rog-light/20 p-4 rounded-lg">
                                <h5 class="text-lg font-rog-heading font-semibold text-white">Total Orders</h5>
                                <p class="text-2xl font-rog-display font-bold text-rog-red">${reportData.totalOrders}</p>
                            </div>
                            <div class="bg-rog-light/20 p-4 rounded-lg">
                                <h5 class="text-lg font-rog-heading font-semibold text-white">Avg Order Value</h5>
                                <p class="text-2xl font-rog-display font-bold text-rog-red">$${reportData.avgOrderValue.toFixed(2)}</p>
                            </div>
                        </div>
                        <div class="bg-rog-light/20 rounded-lg p-6">
                            <h5 class="text-lg font-rog-heading font-semibold text-white mb-4">Sales Details</h5>
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead>
                                        <tr class="border-b border-rog-gray">
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Order ID</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Customer</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Material</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Amount</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Date</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${reportData.orders.slice(0, 10).map(order => `
                                            <tr class="border-b border-rog-gray/50">
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${order.id || 'N/A'}</td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${order.customer || 'N/A'}</td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${order.material || 'N/A'}</td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">$${order.amount || '0.00'}</td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${order.date || 'N/A'}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                    break;
                case 'customers':
                    html += `
                        <div class="grid md:grid-cols-3 gap-4 mb-6">
                            <div class="bg-rog-light/20 p-4 rounded-lg">
                                <h5 class="text-lg font-rog-heading font-semibold text-white">Total Customers</h5>
                                <p class="text-2xl font-rog-display font-bold text-rog-red">${reportData.totalCustomers}</p>
                            </div>
                            <div class="bg-rog-light/20 p-4 rounded-lg">
                                <h5 class="text-lg font-rog-heading font-semibold text-white">Active Customers</h5>
                                <p class="text-2xl font-rog-display font-bold text-rog-red">${reportData.activeCustomers}</p>
                            </div>
                            <div class="bg-rog-light/20 p-4 rounded-lg">
                                <h5 class="text-lg font-rog-heading font-semibold text-white">New Customers</h5>
                                <p class="text-2xl font-rog-display font-bold text-rog-red">${reportData.newCustomers}</p>
                            </div>
                        </div>
                        <div class="bg-rog-light/20 rounded-lg p-6">
                            <h5 class="text-lg font-rog-heading font-semibold text-white mb-4">Customer Details</h5>
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead>
                                        <tr class="border-b border-rog-gray">
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Name</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Email</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Phone</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Status</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Joined</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${reportData.customers.slice(0, 10).map(customer => `
                                            <tr class="border-b border-rog-gray/50">
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${customer.name || 'N/A'}</td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${customer.email || 'N/A'}</td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${customer.phone || 'N/A'}</td>
                                                <td class="py-3 px-4">
                                                    <span class="px-2 py-1 ${getStatusColor(customer.status)} rounded-full text-xs font-rog-body">${customer.status || 'N/A'}</span>
                                                </td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${customer.joined || 'N/A'}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                    break;
                case 'materials':
                    html += `
                        <div class="mb-6">
                            <h5 class="text-lg font-rog-heading font-semibold text-white mb-4">Material Usage</h5>
                            <div class="grid md:grid-cols-2 gap-4 mb-6">
                                ${Object.entries(reportData.materialUsage).map(([material, count]) => `
                                    <div class="bg-rog-light/20 p-4 rounded-lg">
                                        <h6 class="font-rog-heading font-semibold text-white">${material}</h6>
                                        <p class="text-rog-red font-rog-display font-bold">${count} orders</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        <div class="bg-rog-light/20 rounded-lg p-6">
                            <h5 class="text-lg font-rog-heading font-semibold text-white mb-4">Materials Inventory</h5>
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead>
                                        <tr class="border-b border-rog-gray">
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Material</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Type</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Price</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Stock</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${reportData.materials.slice(0, 10).map(material => `
                                            <tr class="border-b border-rog-gray/50">
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${material.name || 'N/A'}</td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${material.type || 'N/A'}</td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">$${material.price || '0.00'}</td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${material.stock || 0}</td>
                                                <td class="py-3 px-4">
                                                    <span class="px-2 py-1 ${getStatusColor(material.status)} rounded-full text-xs font-rog-body">${material.status || 'N/A'}</span>
                                                </td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                    break;
                case 'orders':
                    html += `
                        <div class="mb-6">
                            <h5 class="text-lg font-rog-heading font-semibold text-white mb-4">Order Status Distribution</h5>
                            <div class="grid md:grid-cols-2 gap-4 mb-6">
                                ${Object.entries(reportData.statusCounts).map(([status, count]) => `
                                    <div class="bg-rog-light/20 p-4 rounded-lg">
                                        <h6 class="font-rog-heading font-semibold text-white">${status}</h6>
                                        <p class="text-rog-red font-rog-display font-bold">${count} orders</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        <div class="bg-rog-light/20 rounded-lg p-6">
                            <h5 class="text-lg font-rog-heading font-semibold text-white mb-4">Orders Details</h5>
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead>
                                        <tr class="border-b border-rog-gray">
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Order ID</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Customer</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Material</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Status</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Amount</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Date</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${reportData.orders.slice(0, 10).map(order => `
                                            <tr class="border-b border-rog-gray/50">
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${order.id || 'N/A'}</td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${order.customer || 'N/A'}</td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${order.material || 'N/A'}</td>
                                                <td class="py-3 px-4">
                                                    <span class="px-2 py-1 ${getStatusColor(order.status)} rounded-full text-xs font-rog-body">${order.status || 'N/A'}</span>
                                                </td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">$${order.amount || '0.00'}</td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${order.date || 'N/A'}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                    break;
                case 'revenue':
                    html += `
                        <div class="mb-6">
                            <h5 class="text-lg font-rog-heading font-semibold text-white mb-4">Revenue by Month</h5>
                            <div class="grid md:grid-cols-2 gap-4 mb-6">
                                ${Object.entries(reportData.revenueByMonth).map(([month, revenue]) => `
                                    <div class="bg-rog-light/20 p-4 rounded-lg">
                                        <h6 class="font-rog-heading font-semibold text-white">${month}</h6>
                                        <p class="text-rog-red font-rog-display font-bold">$${revenue.toFixed(2)}</p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        <div class="bg-rog-light/20 rounded-lg p-6">
                            <h5 class="text-lg font-rog-heading font-semibold text-white mb-4">Revenue Details</h5>
                            <div class="overflow-x-auto">
                                <table class="w-full">
                                    <thead>
                                        <tr class="border-b border-rog-gray">
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Order ID</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Customer</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Material</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Amount</th>
                                            <th class="text-left py-3 px-4 font-rog-heading font-semibold text-white">Date</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        ${reportData.orders.slice(0, 10).map(order => `
                                            <tr class="border-b border-rog-gray/50">
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${order.id || 'N/A'}</td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${order.customer || 'N/A'}</td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${order.material || 'N/A'}</td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">$${order.amount || '0.00'}</td>
                                                <td class="py-3 px-4 font-rog-body text-gray-300">${order.date || 'N/A'}</td>
                                            </tr>
                                        `).join('')}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                    break;
            }

            reportContent.innerHTML = html;
            reportPreview.classList.remove('hidden');
        }

        function exportReport(format) {
            const reportType = document.getElementById('reportType').value;
            const dateRange = document.getElementById('dateRange').value;
            const reportData = {
                type: reportType,
                period: getDateRangeLabel(dateRange),
                generatedAt: new Date().toISOString()
            };

            switch (format) {
                case 'pdf':
                    exportToPDF(reportData);
                    break;
                case 'excel':
                    exportToExcel(reportData);
                    break;
                case 'csv':
                    exportToCSV(reportData);
                    break;
            }
        }

        function exportToPDF(reportData) {
            // Simple PDF export using browser print
            const printWindow = window.open('', '_blank');
            printWindow.document.write(`
                <html>
                    <head>
                        <title>${reportData.type} Report - ${reportData.period}</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 20px; }
                            h1 { color: #ff0037; }
                            .header { border-bottom: 2px solid #ff0037; padding-bottom: 10px; margin-bottom: 20px; }
                            .stats { display: flex; gap: 20px; margin: 20px 0; }
                            .stat { background: #f5f5f5; padding: 15px; border-radius: 5px; }
                        </style>
                    </head>
                    <body>
                        <div class="header">
                            <h1>${reportData.type} Report</h1>
                            <p>Period: ${reportData.period}</p>
                            <p>Generated: ${new Date(reportData.generatedAt).toLocaleString()}</p>
                        </div>
                        <div class="content">
                            <p>Report content will be generated here based on the selected data.</p>
                        </div>
                    </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        function exportToExcel(reportData) {
            // Create CSV content for Excel
            const csvContent = `Report Type,${reportData.type}\nPeriod,${reportData.period}\nGenerated,${new Date(reportData.generatedAt).toLocaleString()}\n\n`;

            const blob = new Blob([csvContent], {
                type: 'text/csv'
            });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${reportData.type}_report_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function exportToCSV(reportData) {
            // Create CSV content
            const csvContent = `Report Type,${reportData.type}\nPeriod,${reportData.period}\nGenerated,${new Date(reportData.generatedAt).toLocaleString()}\n\n`;

            const blob = new Blob([csvContent], {
                type: 'text/csv'
            });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${reportData.type}_report_${new Date().toISOString().split('T')[0]}.csv`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        async function loadSettingsData() {
            try {
                console.log('Loading settings data...');
                setupSettingsTabs();
                loadSettingsContent();
            } catch (error) {
                console.error('Error loading settings data:', error);
            }
        }

        // Settings tabs functionality
        function setupSettingsTabs() {
            const settingsTabs = document.querySelectorAll('.settings-tab');
            const settingsContents = document.querySelectorAll('.settings-content');

            settingsTabs.forEach(tab => {
                tab.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetTab = tab.getAttribute('data-tab');

                    // Remove active class from all tabs
                    settingsTabs.forEach(t => {
                        t.classList.remove('active', 'bg-rog-red', 'text-white');
                        t.classList.add('text-gray-400', 'hover:text-white');
                    });

                    // Add active class to clicked tab
                    tab.classList.add('active', 'bg-rog-red', 'text-white');
                    tab.classList.remove('text-gray-400', 'hover:text-white');

                    // Hide all content sections
                    settingsContents.forEach(content => {
                        content.classList.add('hidden');
                    });

                    // Show target content
                    const targetContent = document.getElementById(targetTab + '-settings');
                    if (targetContent) {
                        targetContent.classList.remove('hidden');
                    }
                });
            });
        }

        // Load settings content
        function loadSettingsContent() {
            // Load general settings
            loadGeneralSettings();
            // Load other settings as needed
        }

        // Load general settings data
        function loadGeneralSettings() {
            // Load company settings from localStorage or Firebase
            const companyName = localStorage.getItem('companyName') || '';
            const companyEmail = localStorage.getItem('companyEmail') || '';
            const companyPhone = localStorage.getItem('companyPhone') || '';
            const companyAddress = localStorage.getItem('companyAddress') || '';

            document.getElementById('company-name').value = companyName;
            document.getElementById('company-email').value = companyEmail;
            document.getElementById('company-phone').value = companyPhone;
            document.getElementById('company-address').value = companyAddress;
        }

        // Render functions
        function renderOrdersTable() {
            const tbody = document.getElementById('orders-table-body');
            if (!tbody) return;

            if (ordersData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" class="py-8 text-center text-gray-400 font-rog-body">No orders found</td></tr>';
                return;
            }

            tbody.innerHTML = ordersData.map(order => `
                <tr class="border-b border-rog-gray/50">
                    <td class="py-3 px-4 font-rog-body text-gray-300">${order.id || 'N/A'}</td>
                    <td class="py-3 px-4 font-rog-body text-gray-300">${order.customer || 'N/A'}</td>
                    <td class="py-3 px-4 font-rog-body text-gray-300">${order.material || 'N/A'}</td>
                    <td class="py-3 px-4">
                        <span class="px-2 py-1 ${getStatusColor(order.status)} rounded-full text-xs font-rog-body">${order.status || 'N/A'}</span>
                    </td>
                    <td class="py-3 px-4 font-rog-body text-gray-300">$${order.amount || '0.00'}</td>
                    <td class="py-3 px-4 font-rog-body text-gray-300">${order.date || 'N/A'}</td>
                    <td class="py-3 px-4">
                        <button class="text-rog-red hover:text-rog-orange mr-2" onclick="editOrder('${order.id}')" title="Edit Order">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="text-blue-400 hover:text-blue-300 mr-2" onclick="addJerseyDetails('${order.id}')" title="Add Jersey Details">
                            <i class="fas fa-tshirt"></i>
                        </button>
                        <button class="text-green-400 hover:text-green-300 mr-2" onclick="generateShareLink('${order.id}')" title="Generate Share Link">
                            <i class="fas fa-share"></i>
                        </button>
                        <button class="text-red-400 hover:text-red-300" onclick="deleteOrder('${order.id}')" title="Delete Order">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function renderCustomersTable() {
            const tbody = document.getElementById('customers-table-body');
            if (!tbody) return;

            if (customersData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="py-8 text-center text-gray-400 font-rog-body">No customers found</td></tr>';
                return;
            }

            tbody.innerHTML = customersData.map(customer => `
                <tr class="border-b border-rog-gray/50">
                    <td class="py-3 px-4 font-rog-body text-gray-300">${customer.name || 'N/A'}</td>
                    <td class="py-3 px-4 font-rog-body text-gray-300">${customer.email || 'N/A'}</td>
                    <td class="py-3 px-4 font-rog-body text-gray-300">${customer.phone || 'N/A'}</td>
                    <td class="py-3 px-4 font-rog-body text-gray-300">${customer.orders || 0}</td>
                    <td class="py-3 px-4">
                        <span class="px-2 py-1 ${getStatusColor(customer.status)} rounded-full text-xs font-rog-body">${customer.status || 'N/A'}</span>
                    </td>
                    <td class="py-3 px-4 font-rog-body text-gray-300">${customer.joined || 'N/A'}</td>
                    <td class="py-3 px-4">
                        <button class="text-rog-red hover:text-rog-orange mr-2" onclick="editCustomer('${customer.id}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="text-red-400 hover:text-red-300" onclick="deleteCustomer('${customer.id}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        function renderMaterialsTable() {
            const tbody = document.getElementById('materials-table-body');
            if (!tbody) return;

            if (materialsData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="py-8 text-center text-gray-400 font-rog-body">No materials found</td></tr>';
                return;
            }

            tbody.innerHTML = materialsData.map(material => `
                <tr class="border-b border-rog-gray/50">
                    <td class="py-3 px-4 font-rog-body text-gray-300">${material.name || 'N/A'}</td>
                    <td class="py-3 px-4 font-rog-body text-gray-300">${material.type || 'N/A'}</td>
                    <td class="py-3 px-4 font-rog-body text-gray-300">$${material.price || '0.00'}</td>
                    <td class="py-3 px-4 font-rog-body text-gray-300">${material.stock || 0}</td>
                    <td class="py-3 px-4">
                        <span class="px-2 py-1 ${getStatusColor(material.status)} rounded-full text-xs font-rog-body">${material.status || 'N/A'}</span>
                    </td>
                    <td class="py-3 px-4">
                        <button class="text-rog-red hover:text-rog-orange mr-2" onclick="editMaterial('${material.id}')">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="text-red-400 hover:text-red-300" onclick="deleteMaterial('${material.id}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        // Helper functions
        function getStatusColor(status) {
            const colors = {
                'pending': 'bg-yellow-500/20 text-yellow-400',
                'processing': 'bg-blue-500/20 text-blue-400',
                'completed': 'bg-green-500/20 text-green-400',
                'cancelled': 'bg-red-500/20 text-red-400',
                'active': 'bg-green-500/20 text-green-400',
                'inactive': 'bg-gray-500/20 text-gray-400'
            };
            return colors[status] || 'bg-gray-500/20 text-gray-400';
        }

        // Stats update functions
        async function updateCustomerStats() {
            const totalCustomers = document.getElementById('total-customers');
            const activeCustomers = document.getElementById('active-customers');
            const newCustomers = document.getElementById('new-customers');

            if (totalCustomers) totalCustomers.textContent = customersData.length;
            if (activeCustomers) activeCustomers.textContent = customersData.filter(c => c.status === 'active').length;
            if (newCustomers) newCustomers.textContent = customersData.filter(c => {
                const joinedDate = new Date(c.joined);
                const now = new Date();
                const monthDiff = (now - joinedDate) / (1000 * 60 * 60 * 24 * 30);
                return monthDiff < 1;
            }).length;
        }

        async function updateMaterialStats() {
            const totalMaterials = document.getElementById('total-materials');
            const materialsInStock = document.getElementById('materials-in-stock');
            const materialsLowStock = document.getElementById('materials-low-stock');
            const materialsOutOfStock = document.getElementById('materials-out-of-stock');

            if (totalMaterials) totalMaterials.textContent = materialsData.length;
            if (materialsInStock) materialsInStock.textContent = materialsData.filter(m => m.stock > 10).length;
            if (materialsLowStock) materialsLowStock.textContent = materialsData.filter(m => m.stock <= 10 && m.stock > 0).length;
            if (materialsOutOfStock) materialsOutOfStock.textContent = materialsData.filter(m => m.stock === 0).length;
        }

        async function updateAnalyticsStats() {
            try {
                if (window.firebaseDb && collection) {
                    const ordersRef = collection(window.firebaseDb, 'orders');
                    const ordersSnapshot = await getDocs(ordersRef);
                    const orders = ordersSnapshot.docs.map(doc => doc.data());

                    const totalRevenue = orders.reduce((sum, order) => sum + (parseFloat(order.amount) || 0), 0);
                    const avgOrderValue = orders.length > 0 ? totalRevenue / orders.length : 0;
                    const conversionRate = 3.2; // This would be calculated based on actual data
                    const customerSatisfaction = 94; // This would be calculated based on actual data

                    const totalRevenueEl = document.getElementById('total-revenue');
                    const avgOrderValueEl = document.getElementById('avg-order-value');
                    const conversionRateEl = document.getElementById('conversion-rate');
                    const customerSatisfactionEl = document.getElementById('customer-satisfaction');

                    if (totalRevenueEl) totalRevenueEl.textContent = `$${totalRevenue.toFixed(2)}`;
                    if (avgOrderValueEl) avgOrderValueEl.textContent = `$${avgOrderValue.toFixed(2)}`;
                    if (conversionRateEl) conversionRateEl.textContent = `${conversionRate}%`;
                    if (customerSatisfactionEl) customerSatisfactionEl.textContent = `${customerSatisfaction}%`;
                }
            } catch (error) {
                console.error('Error updating analytics stats:', error);
            }
        }

        // Modal functionality
        function setupModals() {
            // Order modal
            const orderModal = document.getElementById('orderModal');
            const addOrderBtn = document.getElementById('add-order-btn');
            const closeOrderModal = document.getElementById('closeOrderModal');
            const cancelOrder = document.getElementById('cancelOrder');
            const orderForm = document.getElementById('orderForm');

            if (addOrderBtn) {
                addOrderBtn.addEventListener('click', () => {
                    currentEditId = null;
                    document.getElementById('orderModalTitle').textContent = 'Add New Order';
                    orderForm.reset();
                    orderModal.classList.remove('hidden');
                });
            }

            if (closeOrderModal) {
                closeOrderModal.addEventListener('click', () => {
                    orderModal.classList.add('hidden');
                });
            }

            if (cancelOrder) {
                cancelOrder.addEventListener('click', () => {
                    orderModal.classList.add('hidden');
                });
            }

            if (orderForm) {
                orderForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    await saveOrder();
                });
            }

            // Customer modal
            const customerModal = document.getElementById('customerModal');
            const addCustomerBtn = document.getElementById('add-customer-btn');
            const closeCustomerModal = document.getElementById('closeCustomerModal');
            const cancelCustomer = document.getElementById('cancelCustomer');
            const customerForm = document.getElementById('customerForm');

            if (addCustomerBtn) {
                addCustomerBtn.addEventListener('click', () => {
                    currentEditId = null;
                    document.getElementById('customerModalTitle').textContent = 'Add New Customer';
                    customerForm.reset();
                    customerModal.classList.remove('hidden');
                });
            }

            if (closeCustomerModal) {
                closeCustomerModal.addEventListener('click', () => {
                    customerModal.classList.add('hidden');
                });
            }

            if (cancelCustomer) {
                cancelCustomer.addEventListener('click', () => {
                    customerModal.classList.add('hidden');
                });
            }

            if (customerForm) {
                customerForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    await saveCustomer();
                });
            }

            // Material modal
            const materialModal = document.getElementById('materialModal');
            const addMaterialBtn = document.getElementById('add-material-btn');
            const closeMaterialModal = document.getElementById('closeMaterialModal');
            const cancelMaterial = document.getElementById('cancelMaterial');
            const materialForm = document.getElementById('materialForm');

            if (addMaterialBtn) {
                addMaterialBtn.addEventListener('click', () => {
                    currentEditId = null;
                    document.getElementById('materialModalTitle').textContent = 'Add New Material';
                    materialForm.reset();
                    materialModal.classList.remove('hidden');
                });
            }

            if (closeMaterialModal) {
                closeMaterialModal.addEventListener('click', () => {
                    materialModal.classList.add('hidden');
                });
            }

            if (cancelMaterial) {
                cancelMaterial.addEventListener('click', () => {
                    materialModal.classList.add('hidden');
                });
            }

            if (materialForm) {
                materialForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    await saveMaterial();
                });
            }

            // Jersey modal
            const jerseyModal = document.getElementById('jerseyModal');
            const closeJerseyModal = document.getElementById('closeJerseyModal');
            const cancelJersey = document.getElementById('cancelJersey');

            if (closeJerseyModal) {
                closeJerseyModal.addEventListener('click', () => {
                    jerseyModal.classList.add('hidden');
                });
            }

            if (cancelJersey) {
                cancelJersey.addEventListener('click', () => {
                    jerseyModal.classList.add('hidden');
                });
            }
        }

        // Save functions
        async function saveOrder() {
            try {
                const orderData = {
                    customer: document.getElementById('orderCustomer').value,
                    email: document.getElementById('orderEmail').value,
                    material: document.getElementById('orderMaterial').value,
                    quantity: parseInt(document.getElementById('orderQuantity').value),
                    amount: parseFloat(document.getElementById('orderAmount').value),
                    status: document.getElementById('orderStatus').value,
                    notes: document.getElementById('orderNotes').value,
                    date: new Date().toISOString().split('T')[0],
                    createdAt: new Date()
                };

                if (window.firebaseDb && addDoc) {
                    const ordersRef = collection(window.firebaseDb, 'orders');
                    await addDoc(ordersRef, orderData);
                    console.log('Order saved successfully');
                }

                document.getElementById('orderModal').classList.add('hidden');
                await loadOrdersData();
                await loadDashboardData();
            } catch (error) {
                console.error('Error saving order:', error);
            }
        }

        async function saveCustomer() {
            try {
                const customerData = {
                    name: document.getElementById('customerName').value,
                    email: document.getElementById('customerEmail').value,
                    phone: document.getElementById('customerPhone').value,
                    address: document.getElementById('customerAddress').value,
                    status: document.getElementById('customerStatus').value,
                    orders: 0,
                    joined: new Date().toISOString().split('T')[0],
                    createdAt: new Date()
                };

                if (window.firebaseDb && addDoc) {
                    const customersRef = collection(window.firebaseDb, 'customers');
                    await addDoc(customersRef, customerData);
                    console.log('Customer saved successfully');
                }

                document.getElementById('customerModal').classList.add('hidden');
                await loadCustomersData();
            } catch (error) {
                console.error('Error saving customer:', error);
            }
        }

        async function saveMaterial() {
            try {
                const materialData = {
                    name: document.getElementById('materialName').value,
                    type: document.getElementById('materialType').value,
                    price: parseFloat(document.getElementById('materialPrice').value),
                    stock: parseInt(document.getElementById('materialStock').value),
                    description: document.getElementById('materialDescription').value,
                    status: 'active',
                    createdAt: new Date()
                };

                if (window.firebaseDb && addDoc) {
                    const materialsRef = collection(window.firebaseDb, 'materials');
                    await addDoc(materialsRef, materialData);
                    console.log('Material saved successfully');
                }

                document.getElementById('materialModal').classList.add('hidden');
                await loadMaterialsData();
            } catch (error) {
                console.error('Error saving material:', error);
            }
        }

        // Action functions
        function editOrder(orderId) {
            console.log('Edit order:', orderId);
            // Implement edit order functionality
        }

        // Jersey details functionality
        function addJerseyDetails(orderId) {
            const jerseyModal = document.getElementById('jerseyModal');
            if (jerseyModal) {
                // Set the order ID for the jersey details
                document.getElementById('jerseyOrderId').value = orderId;
                jerseyModal.classList.remove('hidden');
            }
        }

        // Generate share link functionality
        function generateShareLink(orderId) {
            const order = ordersData.find(o => o.id === orderId);
            if (!order) {
                alert('Order not found');
                return;
            }

            // Generate a shareable link (in a real app, this would be a proper URL)
            const shareLink = `${window.location.origin}/order-details.html?orderId=${orderId}`;

            // Copy to clipboard
            navigator.clipboard.writeText(shareLink).then(() => {
                alert('Share link copied to clipboard!');
            }).catch(() => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = shareLink;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('Share link copied to clipboard!');
            });
        }

        // Save jersey details
        async function saveJerseyDetails() {
            try {
                const orderId = document.getElementById('jerseyOrderId').value;
                const jerseyData = {
                    type: document.getElementById('jerseyType').value,
                    name: document.getElementById('jerseyName').value,
                    number: document.getElementById('jerseyNumber').value,
                    sizeCategory: document.getElementById('jerseySizeCategory').value,
                    size: document.getElementById('jerseySize').value,
                    sleeve: document.getElementById('jerseySleeve').value,
                    shorts: document.getElementById('jerseyShorts').value,
                    createdAt: new Date()
                };

                if (window.firebaseDb && updateDoc && doc) {
                    const orderRef = doc(window.firebaseDb, 'orders', orderId);
                    await updateDoc(orderRef, {
                        jerseyDetails: jerseyData
                    });
                    console.log('Jersey details saved successfully');

                    // Close modal
                    document.getElementById('jerseyModal').classList.add('hidden');

                    // Reload orders data
                    await loadOrdersData();
                }
            } catch (error) {
                console.error('Error saving jersey details:', error);
                alert('Error saving jersey details. Please try again.');
            }
        }

        async function deleteOrder(orderId) {
            if (confirm('Are you sure you want to delete this order?')) {
                try {
                    if (window.firebaseDb && deleteDoc && doc) {
                        const orderRef = doc(window.firebaseDb, 'orders', orderId);
                        await deleteDoc(orderRef);
                        console.log('Order deleted successfully');
                        await loadOrdersData();
                        await loadDashboardData();
                    }
                } catch (error) {
                    console.error('Error deleting order:', error);
                }
            }
        }

        function editCustomer(customerId) {
            console.log('Edit customer:', customerId);
            // Implement edit customer functionality
        }

        async function deleteCustomer(customerId) {
            if (confirm('Are you sure you want to delete this customer?')) {
                try {
                    if (window.firebaseDb && deleteDoc && doc) {
                        const customerRef = doc(window.firebaseDb, 'customers', customerId);
                        await deleteDoc(customerRef);
                        console.log('Customer deleted successfully');
                        await loadCustomersData();
                    }
                } catch (error) {
                    console.error('Error deleting customer:', error);
                }
            }
        }

        function editMaterial(materialId) {
            console.log('Edit material:', materialId);
            // Implement edit material functionality
        }

        async function deleteMaterial(materialId) {
            if (confirm('Are you sure you want to delete this material?')) {
                try {
                    if (window.firebaseDb && deleteDoc && doc) {
                        const materialRef = doc(window.firebaseDb, 'materials', materialId);
                        await deleteDoc(materialRef);
                        console.log('Material deleted successfully');
                        await loadMaterialsData();
                    }
                } catch (error) {
                    console.error('Error deleting material:', error);
                }
            }
        }

        // Notification functionality
        function setupNotifications() {
            const notificationBtn = document.getElementById('notification-btn');
            const notificationCenter = document.getElementById('notification-center');
            const notificationCount = document.getElementById('notification-count');

            if (notificationBtn && notificationCenter) {
                notificationBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    notificationCenter.classList.toggle('hidden');
                });

                // Close notification center when clicking outside
                document.addEventListener('click', (e) => {
                    if (!notificationBtn.contains(e.target) && !notificationCenter.contains(e.target)) {
                        notificationCenter.classList.add('hidden');
                    }
                });
            }
        }

        // User profile dropdown functionality
        function setupUserProfile() {
            const userProfileBtn = document.getElementById('user-profile-btn');
            const userDropdown = document.getElementById('user-dropdown');

            if (userProfileBtn && userDropdown) {
                userProfileBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    userDropdown.classList.toggle('hidden');
                });

                // Close dropdown when clicking outside
                document.addEventListener('click', (e) => {
                    if (!userProfileBtn.contains(e.target) && !userDropdown.contains(e.target)) {
                        userDropdown.classList.add('hidden');
                    }
                });
            }
        }

        // Load admin user information
        function loadAdminUserInfo() {
            const adminUser = localStorage.getItem('adminUser');
            if (adminUser) {
                try {
                    const adminData = JSON.parse(adminUser);
                    const adminName = document.getElementById('admin-name');
                    const adminEmail = document.getElementById('admin-email');
                    const adminAvatar = document.getElementById('admin-avatar');

                    if (adminName) adminName.textContent = adminData.name || 'Admin User';
                    if (adminEmail) adminEmail.textContent = adminData.email || 'admin@otomono.mv';

                    if (adminAvatar && adminData.name) {
                        const initial = adminData.name.charAt(0).toUpperCase();
                        adminAvatar.innerHTML = `<span class="text-white text-sm font-rog-heading font-bold">${initial}</span>`;
                    }
                } catch (error) {
                    console.error('Error loading admin user info:', error);
                }
            }
        }

        // Session duration tracking
        function updateSessionDuration() {
            const adminUser = localStorage.getItem('adminUser');
            if (adminUser) {
                try {
                    const adminData = JSON.parse(adminUser);
                    const loginTime = new Date(adminData.loginTime);
                    const now = new Date();
                    const diffMs = now - loginTime;
                    const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
                    const diffMinutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));

                    const sessionDuration = document.getElementById('session-duration');
                    if (sessionDuration) {
                        sessionDuration.textContent = `${diffHours}h ${diffMinutes}m`;
                    }
                } catch (error) {
                    console.error('Error updating session duration:', error);
                }
            }
        }

        // Logout functionality
        function logout() {
            localStorage.removeItem('adminUser');
            window.location.href = 'login.html';
        }

        // Test navigation function
        function testNavigation() {
            console.log('Testing navigation...');
            const navLinks = document.querySelectorAll('nav a[href^="#"]');
            console.log('Navigation links found:', navLinks.length);
            navLinks.forEach((link, index) => {
                console.log(`Link ${index}:`, link.getAttribute('href'), link.textContent.trim());
            });
            
            // Test if sections exist
            const sections = document.querySelectorAll('main > section');
            console.log('Available sections:');
            sections.forEach(section => {
                console.log(`- ${section.id}: ${section.classList.contains('hidden') ? 'hidden' : 'visible'}`);
            });
        }

        // Manual navigation test
        function testPageNavigation(pageId) {
            console.log(`Testing navigation to: ${pageId}`);
            showPage(pageId);
        }

        // Make functions global
        window.logout = logout;
        window.editOrder = editOrder;
        window.deleteOrder = deleteOrder;
        window.editCustomer = editCustomer;
        window.deleteCustomer = deleteCustomer;
        window.editMaterial = editMaterial;
        window.deleteMaterial = deleteMaterial;
        window.addJerseyDetails = addJerseyDetails;
        window.generateShareLink = generateShareLink;
        window.saveJerseyDetails = saveJerseyDetails;
        window.testNavigation = testNavigation;
        window.testPageNavigation = testPageNavigation;
        window.showPage = showPage;

        // Initialize all functionality
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('Admin panel initializing...');
            await initializeFirebase();
            setupMobileSidebar();
            setupNavigation();
            setupModals();
            setupNotifications();
            setupUserProfile();
            loadAdminUserInfo();
            updateSessionDuration();

            // Update session duration every minute
            setInterval(updateSessionDuration, 60000);

            // Load initial dashboard data
            await loadDashboardData();

            // Ensure navigation is working
            setTimeout(() => {
                console.log('Re-checking navigation setup...');
                setupNavigation();
            }, 1000);
        });
    </script>

    <!-- Order Modal -->
    <div id="orderModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-rog-light rounded-2xl p-6 w-full max-w-2xl">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-rog-display font-bold text-white" id="orderModalTitle">Add New Order</h3>
                    <button id="closeOrderModal" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <form id="orderForm" class="space-y-4">
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Customer Name</label>
                            <input type="text" id="orderCustomer" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter customer name" required>
                        </div>
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Customer Email</label>
                            <input type="email" id="orderEmail" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter customer email" required>
                        </div>
                    </div>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Material</label>
                            <select id="orderMaterial" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-rog-red" required>
                                <option value="">Select Material</option>
                                <option value="Waffle">Waffle</option>
                                <option value="Combweb">Combweb</option>
                                <option value="Vortex Jacquard">Vortex Jacquard</option>
                                <option value="Mesh">Mesh</option>
                                <option value="Iceburg">Iceburg</option>
                                <option value="Nano Check">Nano Check</option>
                                <option value="Closehole">Closehole</option>
                                <option value="Drytec">Drytec</option>
                                <option value="Wetlook">Wetlook</option>
                                <option value="Baby Pk">Baby Pk</option>
                                <option value="Cool Tech">Cool Tech</option>
                                <option value="Net">Net</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Quantity</label>
                            <input type="number" id="orderQuantity" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter quantity" min="1" required>
                        </div>
                    </div>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Amount</label>
                            <input type="number" id="orderAmount" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter amount" step="0.01" required>
                        </div>
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Status</label>
                            <select id="orderStatus" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-rog-red" required>
                                <option value="pending">Pending</option>
                                <option value="processing">Processing</option>
                                <option value="shipped">Shipped</option>
                                <option value="delivered">Delivered</option>
                                <option value="cancelled">Cancelled</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Notes</label>
                        <textarea id="orderNotes" rows="3" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter order notes"></textarea>
                    </div>
                    <div class="flex justify-end space-x-4">
                        <button type="button" id="cancelOrder" class="px-6 py-3 bg-gray-600 text-white rounded-lg font-rog-heading font-semibold hover:bg-gray-700 transition-colors duration-300">Cancel</button>
                        <button type="submit" class="rog-button px-6 py-3 rounded-lg font-rog-heading font-semibold text-white">Save Order</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Customer Modal -->
    <div id="customerModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-rog-light rounded-2xl p-6 w-full max-w-2xl">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-rog-display font-bold text-white" id="customerModalTitle">Add New Customer</h3>
                    <button id="closeCustomerModal" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <form id="customerForm" class="space-y-4">
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Full Name</label>
                            <input type="text" id="customerName" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter full name" required>
                        </div>
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Email</label>
                            <input type="email" id="customerEmail" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter email" required>
                        </div>
                    </div>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Phone</label>
                            <input type="tel" id="customerPhone" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter phone number" required>
                        </div>
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Status</label>
                            <select id="customerStatus" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-rog-red" required>
                                <option value="active">Active</option>
                                <option value="inactive">Inactive</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Address</label>
                        <textarea id="customerAddress" rows="3" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter address"></textarea>
                    </div>
                    <div class="flex justify-end space-x-4">
                        <button type="button" id="cancelCustomer" class="px-6 py-3 bg-gray-600 text-white rounded-lg font-rog-heading font-semibold hover:bg-gray-700 transition-colors duration-300">Cancel</button>
                        <button type="submit" class="rog-button px-6 py-3 rounded-lg font-rog-heading font-semibold text-white">Save Customer</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Material Modal -->
    <div id="materialModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-rog-light rounded-2xl p-6 w-full max-w-2xl">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-rog-display font-bold text-white" id="materialModalTitle">Add New Material</h3>
                    <button id="closeMaterialModal" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <form id="materialForm" class="space-y-4">
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Material Name</label>
                            <select id="materialName" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-rog-red" required>
                                <option value="">Select Material</option>
                                <option value="Waffle">Waffle</option>
                                <option value="Combweb">Combweb</option>
                                <option value="Vortex Jacquard">Vortex Jacquard</option>
                                <option value="Mesh">Mesh</option>
                                <option value="Iceburg">Iceburg</option>
                                <option value="Nano Check">Nano Check</option>
                                <option value="Closehole">Closehole</option>
                                <option value="Drytec">Drytec</option>
                                <option value="Wetlook">Wetlook</option>
                                <option value="Baby Pk">Baby Pk</option>
                                <option value="Cool Tech">Cool Tech</option>
                                <option value="Net">Net</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Material Type</label>
                            <select id="materialType" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-rog-red" required>
                                <option value="">Select Type</option>
                                <option value="Fabric">Fabric</option>
                                <option value="Mesh">Mesh</option>
                                <option value="Technical">Technical</option>
                                <option value="Performance">Performance</option>
                            </select>
                        </div>
                    </div>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Price per Unit</label>
                            <input type="number" id="materialPrice" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter price per unit" step="0.01" required>
                        </div>
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Stock Quantity</label>
                            <input type="number" id="materialStock" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter stock quantity" min="0" required>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Description</label>
                        <textarea id="materialDescription" rows="3" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter material description"></textarea>
                    </div>
                    <div class="flex justify-end space-x-4">
                        <button type="button" id="cancelMaterial" class="px-6 py-3 bg-gray-600 text-white rounded-lg font-rog-heading font-semibold hover:bg-gray-700 transition-colors duration-300">Cancel</button>
                        <button type="submit" class="rog-button px-6 py-3 rounded-lg font-rog-heading font-semibold text-white">Save Material</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Jersey Details Modal -->
    <div id="jerseyModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-rog-light rounded-2xl p-6 w-full max-w-2xl">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-2xl font-rog-display font-bold text-white">Add Jersey Details</h3>
                    <button id="closeJerseyModal" class="text-gray-400 hover:text-white">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                <form id="jerseyForm" class="space-y-4">
                    <input type="hidden" id="jerseyOrderId">

                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Jersey Type</label>
                            <select id="jerseyType" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-rog-red" required>
                                <option value="">Select Jersey Type</option>
                                <option value="Player Jersey">Player Jersey</option>
                                <option value="Keeper Jersey">Keeper Jersey</option>
                                <option value="Official Jersey">Official Jersey</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Jersey Name</label>
                            <input type="text" id="jerseyName" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter jersey name" required>
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Jersey Number</label>
                            <input type="text" id="jerseyNumber" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-rog-red" placeholder="Enter jersey number" required>
                        </div>
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Size Category</label>
                            <select id="jerseySizeCategory" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-rog-red" required>
                                <option value="">Select Size Category</option>
                                <option value="Adult">Adult</option>
                                <option value="Kids">Kids</option>
                                <option value="Muslima">Muslima</option>
                            </select>
                        </div>
                    </div>

                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Size</label>
                            <select id="jerseySize" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-rog-red" required>
                                <option value="">Select Size</option>
                                <option value="XS">XS</option>
                                <option value="S">S</option>
                                <option value="M">M</option>
                                <option value="L">L</option>
                                <option value="XL">XL</option>
                                <option value="2XL">2XL</option>
                                <option value="3XL">3XL</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Sleeve</label>
                            <select id="jerseySleeve" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-rog-red" required>
                                <option value="">Select Sleeve</option>
                                <option value="Short Sleeve">Short Sleeve</option>
                                <option value="Long Sleeve">Long Sleeve</option>
                            </select>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-rog-heading font-medium text-rog-red mb-2">Shorts</label>
                        <select id="jerseyShorts" class="w-full px-4 py-3 bg-rog-light/20 border border-rog-red/30 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-rog-red" required>
                            <option value="">Select Shorts</option>
                            <option value="Yes">Yes</option>
                            <option value="No">No</option>
                        </select>
                    </div>

                    <div class="flex justify-end space-x-4">
                        <button type="button" id="cancelJersey" class="px-6 py-3 bg-gray-600 text-white rounded-lg font-rog-heading font-semibold hover:bg-gray-700 transition-colors duration-300">Cancel</button>
                        <button type="button" onclick="saveJerseyDetails()" class="rog-button px-6 py-3 rounded-lg font-rog-heading font-semibold text-white">Save Jersey Details</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</body>

</html>